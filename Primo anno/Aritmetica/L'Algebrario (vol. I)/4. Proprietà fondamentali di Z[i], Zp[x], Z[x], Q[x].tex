\chapter{Irriducibili e corollari di aritmetica in \texorpdfstring{$\ZZi$}{Z[i]}}

Come già dimostrato, $\ZZi$ è un anello euclideo con la seguente
funzione grado:

\[ g : \ZZi \setminuszero \to \ZZ,\, a+bi \mapsto  \norm{a+bi}^2.\]

A partire da questo preconcetto è possibile dimostrare un teorema
importante in aritmetica, il \nameref{th:teorema_natale},
che discende direttamente come corollario di un teorema più
generale riguardante $\ZZi$.

\section{Il teorema di Natale di Fermat e gli irriducibili in \texorpdfstring{$\ZZi$}{Z[i]}}

\begin{lemma}
    \label{lem:riducibile_due_quadrati}
    Sia $p$ un numero primo riducibile in $\ZZi$, allora $p$
    può essere scritto come somma di due quadrati in $\ZZ$.
\end{lemma}

\begin{proof}
    Se $p$ è riducibile in $\ZZi$, allora esistono $a+bi$ e
    $c+di$ appartenenti a $\ZZi \setminus \ZZi^*$ tali che $p=(a+bi)(c+di)$. \\

    Impiegando le proprietà dell'operazione di coniugio si
    ottiene la seguente equazione:

    \[ \overline{p}=p=(a-bi)(c-di) \implies p^2=p \overline{p} = (a^2+b^2)(c^2+d^2). \]

    Dal momento che $a+bi$ e $c+di$ non sono invertibili,
    i valori della funzione grado calcolati in essi sono strettamente
    maggiori del valore assunto nell'unità, ovverosia:

    \[ a^2+b^2>1, \qquad c^2+d^2>1. \]

    Allora devono per forza valere le seguenti equazioni:

    \[ p=a^2+b^2, \qquad p=c^2+d^2, \]

    da cui la tesi.
\end{proof}

\begin{lemma}
    \label{lem:quadrato_mod_4}
    Sia $p$ un numero primo tale che $p \equiv 1 \pmod4$. Allora
    esiste un $x \in \ZZ$ tale che $p \mid x^2+1$.
\end{lemma}

\begin{proof}
    Per il \textit{Teorema di Wilson}, $(p-1)! \equiv -1 \pmod p$.
    Attraverso varie manipolazioni algebriche si ottiene:

    \[-1 \equiv 1 \cdots \frac{p-1}{2} \cdot \frac{p+1}{2} \cdots (p-1) \equiv 1 \cdots \frac{p-1}{2} \left(-\frac{p-1}{2}\right) \cdots (-1) \equiv\]

    \[ \equiv (-1)^{\frac{p-1}{2}} \left(\left( \frac{p-1}{2} \right)!\right)^2 \equiv
        \left(\left( \frac{p-1}{2} \right)!\right)^2 \pmod p,
    \]

    \vskip 0.1in

    da cui con $x = \left( \frac{p-1}{2} \right)!$ si verifica la
    tesi.
\end{proof}

\begin{theorem}
    \label{th:primo_1_mod_4_riducibile}
    Sia $p$ un numero primo tale che $p \equiv 1 \pmod4$. Allora
    $p$ è riducibile in $\ZZi$.
\end{theorem}

\begin{proof}
    Per il \textit{Lemma \ref{lem:quadrato_mod_4}}, si ha che esiste
    un $x \in \ZZ$ tale che $p \mid x^2+1$. Se $p$ fosse irriducibile,
    dacché $\ZZi$ è un PID in quanto euclideo, $p$ sarebbe anche un
    primo di $\ZZi$. Dal momento che $x^2+1=(x+i)(x-i)$, $p$ dovrebbe
    dividere almeno uno di questi due fattori. \\

    Senza perdità di generalità, si ponga che $p \mid (x+i)$. Allora
    $\exists a+bi \in \ZZi \mid x+i=(a+bi)p$. Uguagliando le parti
    immaginarie si ottiene $bp=1$, che non ammette soluzioni, \Lightning{}. Pertanto $p$ è riducibile.
\end{proof}

\begin{corollary}[\textit{Teorema di Natale di Fermat}]
    \label{th:teorema_natale}
    Sia $p$ un numero primo tale che $p \equiv 1 \pmod4$. Allora
    $p$ è somma di due quadrati in $\ZZ$.
\end{corollary}

\begin{proof}
    Per il \textit{Teorema \ref{th:primo_1_mod_4_riducibile}},
    $p$ è riducibile in $\ZZi$. In quanto riducibile in $\ZZi$, per
    il \textit{Lemma \ref{lem:riducibile_due_quadrati}}, $p$ è allora
    somma di due quadrati.
\end{proof}

\begin{theorem}
    \label{th:primo_-1_mod_4_irriducibile}
    Sia $p$ un numero primo tale che $p \equiv -1 \pmod4$. Allora
    $p$ è irriducibile in $\ZZi$.
\end{theorem}

\begin{proof}
    Se $p$ fosse riducibile in
    $\ZZi$, per il \nameref{th:teorema_natale} esisterebbero $a$ e $b$
    in $\ZZ$ tali che $p=a^2+b^2$. Dal momento che $p$ è dispari,
    possiamo supporre, senza perdità di generalità, che
    $a$ sia pari e che $b$ sia dispari. Pertanto $a^2 \equiv 0 \pmod 4$ e $b^2 \equiv 1 \pmod 4$, dacché sono uno pari e l'altro dispari\footnote{Infatti, $0^2 \equiv 0
            \pmod4$, $1^2 \equiv 1 \pmod4$, $2^2 \equiv 4 \equiv 0 \pmod 4$,
        $3^2 \equiv 9 \equiv 1 \pmod 4$.}. Tuttavia la congruenza
    $a^2+b^2 \equiv 1 \equiv -1 \pmod4$ non è mai soddisfatta,
    \Lightning{}. Pertanto $p$ può essere solo irriducibile.
\end{proof}

\begin{remark*}
    Si osserva che $2=(1+i)(1-i)$. Dal momento che $\norm{1+i}^2=
        \norm{1-i}^2=2\neq1$, si deduce che nessuno dei due fattori
    è invertibile. Pertanto $2$ non è irriducibile.
\end{remark*}

\begin{proposition}
    \label{prop:irriducibili_zz_zzi}
    Gli unici primi $p \in \ZZ$ irriducibili in $\ZZi$ sono i primi $p$ tali
    che $p \equiv -1 \pmod4$.
\end{proposition}

\begin{proof}
    Per l'osservazione precedente, $2$ non è irriducibile in $\ZZi$,
    così come i primi congrui a $1$ in modulo $4$,
    per il \textit{Teorema \ref{th:primo_1_mod_4_riducibile}}. Al
    contrario i primi $p$ congrui a $-1$ in modulo $4$ sono
    irriducibili, per il \textit{Teorema \ref{th:primo_-1_mod_4_irriducibile}}, da cui la tesi.
\end{proof}

\begin{theorem}
    $z \in \ZZi$ è irriducibile se e solo se $z$ è un associato di un $k \in \ZZ$ tale che $k \equiv -1 \pmod 4$, o se $\norm{z}^2$ è primo.
\end{theorem}

\begin{proof} Si dimostrano le due implicazioni separatamente. \\

    ($\implies$)\; Sia $z \in \ZZi$ irriducibile. Chiaramente
    $z \mid z \overline{z} = g(z)$. Dacché $\ZZ$ è un UFD,
    $g(z)$ può decomporsi in un prodotto di primi $q_1q_2\cdots q_n$.
    Dal momento che $\ZZi$ è un PID, in quanto anello euclideo,
    $z$ deve dividere uno dei primi della fattorizzazione di
    $g(z)$. Si assuma che tale primo sia $q_i$. Allora esiste
    un $w \in \ZZi$ tale che $q_i=wz$. \\

    Se $w \in \ZZi^*$, si
    deduce che $z$ è un associato di $q_i$. Dal momento che
    $z$ è irriducibile, $q_i$, che è suo associato, è a sua
    volta irriducibile. Allora, per la \textit{Proposizione \ref{prop:irriducibili_zz_zzi}}, $q_i \equiv -1 \pmod4$.
    \\

    Altrimenti, se $w$ non è invertibile, si ha che $g(w)>g(1)$,
    ossia che $\norm{w}^2>1$. Inoltre in quanto irriducibile, anche
    $z$ non è invertibile, e quindi
    $g(z)>g(1) \implies \norm{z}^2>1$. Dalla proprietà
    moltiplicativa
    del modulo si ricava $q_i^2 = \norm{q_i}^2 = \norm{w}^2 \norm{z}^2$,
    da cui necessariamente consegue che:

    \[ \norm{w}^2=q_i, \quad \norm{z}^2=q_i, \]

    attraverso cui si verifica l'implicazione. \\

    ($\,\Longleftarrow\,\,$)\; Se $k \in \ZZ$ e $k \equiv -1 \pmod4$, per
    il \textit{Teorema \ref{th:primo_-1_mod_4_irriducibile}}, $k$ è
    irriducibile. Allora in quanto suo associato, anche $z$ è irriducibile. \\

    Altrimenti, se $\norm{z}^2$ è un primo $p$, si ponga
    $z=ab$ con $a$ e $b \in \ZZi$. Per la proprietà moltiplicativa
    del modulo, $p = \norm{z}^2 = \norm{ab}^2 = \norm{a}^2\norm{b}^2$.
    Tuttavia questo implica che uno tra $\norm{a}^2$ e $\norm{b}^2$
    sia pari a $1$, ossia che uno tra $a$ e $b$ sia invertibile,
    dacché $g(1)=1$. Pertanto $z$ è in ogni caso irriducibile.
\end{proof}

Infine si enuncia un'ultima identità inerente all'aritmetica, ma
strettamente collegata a $\ZZi$.

\section{L'identità di Brahmagupta-Fibonacci}

\begin{proposition}[\textit{Identità di Brahmagupta-Fibonacci}]
    \label{prop:fibonacci}
    Il prodotto di due somme di quadrati è ancora una
    somma di quadrati. In particolare:

    \[ (a^2+b^2)(c^2+d^2)=(ac-bd)^2+(ad+bc)^2. \]
\end{proposition}

\begin{proof}
    La dimostrazione altro non è che una banale verifica
    algebrica. Ciononostante è possibile risalire a questa
    identità in via alternativa mediante l'uso
    del modulo dei numeri complessi. \\

    Siano $z_1=a+bi$, $z_2=c+di \in \CC$. Allora, per le proprietà
    del modulo dei numeri complessi:

    \begin{equation}
        \label{eq:modulo_z}
        \norm{z_1}\norm{z_2}=\norm{z_1z_2}.
    \end{equation}


    Computando il prodotto tra $z_1$ e $z_2$ si ottiene:

    \[ z_1z_2 = (ac-bd) + (ad+bc)i, \]

    da cui a sua volta si ricava:

    \[ \norm{z_1z_2} = \sqrt{(ac-bd)^2 + (ad+bc)^2}, \]

    assieme a:

    \[ \norm{z_1}=\sqrt{a^2+b^2}, \quad \norm{z_2}=\sqrt{c^2+d^2}. \]

    Infine, da \eqref{eq:modulo_z}, elevando al quadrato, si deduce l'identità
    presentata:

    \begin{multline*}
        \sqrt{a^2+b^2}\sqrt{c^2+d^2}=\sqrt{(ac-bd)^2 + (ad+bc)^2} \implies (a^2+b^2)(c^2+d^2)= \\ (ac-bd)^2+(ad+bc)^2.
    \end{multline*}
\end{proof}

\begin{example}
    Si consideri $65=5 \cdot 13$. Dal momento che sia $5$
    che $13$ sono congrui a $1$ in modulo $4$, sappiamo
    già si possono scrivere entrambi come somme di due
    quadrati. Allora, dall'\nameref{prop:fibonacci},
    anche $65$ è somma di due quadrati. \\

    Infatti $5=2^2+1^2$ e $13=3^2+2^2$. Pertanto
    $65=5\cdot 13=(2\cdot3-1\cdot2)^2 + (2\cdot2+1\cdot3)^2=4^2+7^2$.
\end{example}

