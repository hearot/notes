\chapter{Introduzione al prodotto scalare}

\begin{note}
	Nel corso del documento, per $V$, qualora non specificato, si intenderà uno spazio vettoriale di dimensione
	finita $n$.
\end{note}

\section{Prime definizioni}

\subsection{Prodotto scalare}

\begin{definition}
	Un \textbf{prodotto scalare} su $V$ è una forma bilineare simmetrica $\varphi$ con argomenti in $V$.
\end{definition}

\begin{example}
	Sia $\varphi : M(n, \KK)^2 \to \KK$ tale che $\varphi(A, B) = \tr(AB)$. \\
	
	\li $\varphi(A + A', B) = \tr((A + A')B) = \tr(AB + A'B) = \tr(AB) + \tr(A'B) = \varphi(A, B) + \varphi(A', B)$ (linearità
	nel primo argomento), \\
	\li $\varphi(\alpha A, B) = \tr(\alpha A B) = \alpha \tr(AB) = \alpha \varphi(A, B)$ (omogeneità nel primo argomento), \\
	\li $\varphi(A, B) = \tr(AB) = \tr(BA) = \varphi(B, A)$ (simmetria), \\
	\li poiché $\varphi$ è simmetrica, $\varphi$ è lineare e omogenea anche nel secondo argomento, e quindi è una
	forma bilineare simmetrica, ossia un prodotto scalare su $M(n, \KK)$.
\end{example}

\begin{definition}
	Si definisce prodotto scalare \textit{canonico} di $\KK^n$ la forma bilineare simmetrica $\varphi$ con
	argomenti in $\KK^n$ tale che:
	
	\[ \varphi((x_1, ..., x_n), (y_1, ..., y_n)) = \sum_{i=1}^n x_i y_i. \]
\end{definition}

\begin{remark}
	Si può facilmente osservare che il prodotto scalare canonico di $\KK^n$ è effettivamente un prodotto
	scalare. \\
	
	\li $\varphi((x_1, ..., x_n) + (x_1', ..., x_n'), (y_1, ..., y_n)) = \sum_{i=1}^n (x_i + x_i') y_i =
	\sum_{i=1}^n \left[x_iy_i + x_i' y_i\right] = \sum_{i=1}^n x_i y_i + \sum_{i=1}^n x_i' y_i =
	\varphi((x_1, ..., x_n), (y_1, ..., y_n)) + \varphi((x_1', ..., x_n'), (y_1, ..., y_n))$ (linearità nel
	primo argomento), \\
	\li $\varphi(\alpha(x_1, ..., x_n), (y_1, ..., y_n)) = \sum_{i=1}^n \alpha x_i y_i = \alpha \sum_{i=1}^n x_i y_i =
	\alpha \varphi((x_1, ..., x_n), (y_1, ..., y_n))$ (omogeneità nel primo argomento), \\
	\li $\varphi((x_1, ..., x_n), (y_1, ..., y_n)) = \sum_{i=1}^n x_i y_i = \sum_{i=1}^n y_i x_i = \varphi((y_1, ..., y_n), (x_1, ..., x_n))$ (simmetria), \\
	\li poiché $\varphi$ è simmetrica, $\varphi$ è lineare e omogenea anche nel secondo argomento, e quindi è una
	forma bilineare simmetrica, ossia un prodotto scalare su $\KK^n$.
\end{remark}

\begin{example}
	Altri esempi di prodotto scalare sono i seguenti: \\
	
	\li $\varphi(A, B) = \tr(A^\top B)$ per $M(n, \KK)$, \\
	\li $\varphi(p(x), q(x)) = p(a) q(a)$ per $\KK[x]$, con $a \in \KK$, \\
	\li $\varphi(p(x), q(x)) = \sum_{i=1}^n p(x_i) q(x_i)$ per $\KK[x]$, con $x_1$, ..., $x_n$ distinti, \\
	\li $\varphi(p(x), q(x)) = \int_a^b p(x)q(x) dx$ per lo spazio delle funzioni integrabili su $\RR$, con $a$, $b$ in $\RR$, \\
	\li $\varphi(\vec{x}, \vec{y}) = \vec{x}^\top A \vec{y}$ per $\KK^n$, con $A \in M(n, \KK)$ simmetrica.
\end{example}

\subsection{Prodotto definito o semidefinito}

\begin{definition}
	Sia\footnote{In realtà, la definizione è facilmente estendibile a qualsiasi campo, purché esso
		sia ordinato.} $\KK = \RR$. Allora un prodotto scalare $\varphi$ si dice \textbf{definito positivo} se $\v \in V$, $\vec{v} \neq \vec{0} \implies
	\varphi(\vec{v}, \vec{v}) > 0$. Analogamente $\varphi$ è \textbf{definito negativo} se $\vec{v} \neq \vec 0 \implies \varphi(\v, \v) < 0$. In generale si dice che $\varphi$ è \textbf{definito} se è definito positivo o
	definito negativo. \\
	
	Infine, $\varphi$ è \textbf{semidefinito positivo} se $\varphi(\v, \v) \geq 0$ $\forall \v \in V$ (o
	\textbf{semidefinito negativo} se invece $\varphi(\v, \v) \leq 0$ $\forall \v \in V$). Analogamente ai
	prodotti definiti, si dice che $\varphi$ è \textbf{semidefinito} se è semidefinito positivo o semidefinito
	negativo.
\end{definition}

\begin{example}
	Il prodotto scalare canonico di $\RR^n$ è definito positivo: infatti $\varphi((x_1, ..., x_n), (x_1, ..., x_n)) =
	\sum_{i=1}^n x_i^2  > 0$, se $(x_1, ..., x_n) \neq \vec 0$. \\
	
	Al contrario, il prodotto scalare $\varphi : \RR^2 \to \RR$ tale che $\varphi((x_1, x_2), (y_1, y_2)) = x_1 y_1 - x_2 y_2$ non è definito positivo: $\varphi((x, y), (x, y)) = 0$, $\forall$ $(x, y) \mid x^2 = y^2$, ossia se
	$y = x$ o $y = -x$.
\end{example}

\section{Il radicale di un prodotto scalare}

\subsection{La forma quadratica $q$ associata a \texorpdfstring{$\varphi$}{φ} e vettori isotropi}

\begin{definition}
	Ad un dato prodotto scalare $\varphi$ di $V$ si associa una mappa
	$q : V \to \KK$, detta \textbf{forma quadratica}, tale che $q(\vec{v}) = \varphi(\vec{v}, \vec{v})$.
\end{definition}

\begin{remark}
	Si osserva che $q$ non è lineare in generale: infatti $q(\vec{v} + \vec{w}) \neq q(\vec{v}) + q(\vec{w})$ in
	$\RR^n$.
\end{remark}

\begin{definition}
	Un vettore $\vec{v} \in V$ si dice \textbf{isotropo} rispetto al prodotto scalare $\varphi$ se $q(\vec{v}) =
	\varphi(\vec{v}, \vec{v}) = 0$.
\end{definition}

\begin{example}
	Rispetto al prodotto scalare $\varphi : \RR^3 \to \RR$ tale che $\varphi((x_1, x_2, x_3), (y_1, y_2, y_3)) =
	x_1 y_1 + x_2 y_2 - x_3 y_3$, i vettori isotropi sono i vettori della forma $(x, y, z)$ tali che $x^2 + y^2 = z^2$, ossia
	i vettori stanti sul cono di equazione $x^2 + y^2 = z^2$.
\end{example}

\subsection{Matrice associata a \texorpdfstring{$\varphi$}{φ} e congruenza}

\begin{remark}
	Come già osservato in generale per le applicazioni multilineari, il prodotto scalare è univocamente determinato
	dai valori che assume nelle coppie $\vv{i}, \vv{j}$ estraibili da una base $\basis$. Infatti, se
	$\basis = (\vv1, ..., \vv{k})$, $\vec{v} = \sum_{i=1}^k \alpha_i \vv{i}$ e $\vec{w} = \sum_{i=1}^k \beta_i \vv{i}$,
	allora:
	
	\[ \varphi(\vec{v}, \vec{w}) = \sum_{i=1}^k \sum_{j=1}^k \alpha_i \beta_j \, \varphi(\vv{i}, \vv{j}). \]
\end{remark}

\begin{definition}
	Sia $\varphi$ un prodotto scalare di $V$ e sia $\basis = (\vv1, ..., \vv{n})$ una base ordinata di $V$. Allora si definisce la \textbf{matrice associata}
	a $\varphi$ come la matrice:
	
	\[ M_\basis(\varphi) = (\varphi(\vv{i}, \vv{j}))_{i,\,j = 1\text{---}n} \in M(n, \KK). \] 
\end{definition}

\begin{remark}\nl
	\li $M_\basis(\varphi)$ è simmetrica, infatti $\varphi(\vv{i}, \vv{j}) = \varphi(\vv{j}, \vv{i})$,
	dal momento che il prodotto scalare è simmetrico, \\
	\li $\varphi(\vec{v}, \vec{w}) = [\vec{v}]_\basis^\top M_\basis(\varphi) [\vec{w}]_\basis$.
\end{remark}

\begin{theorem} (di cambiamento di base per matrici di prodotti scalari) Siano $\basis$, $\basis'$ due
	basi ordinate di $V$. Allora, se $\varphi$ è un prodotto scalare di $V$ e $P = M^{\basis'}_{\basis}(\Id_V)$, vale la seguente identità:
	
	\[ \underbrace{M_{\basis'}(\varphi)}_{A'} = P^\top \underbrace{M_{\basis}}_{A} P. \]
\end{theorem}

\begin{proof} Siano $\basis = (\vv{1}, ..., \vv{n})$ e $\basis' = (\vec{w}_1, ..., \vec{w}_n)$. Allora
	$A'_{ij} = \varphi(\vec{w}_i, \vec{w}_j) = [\vec{w}_i]_{\basis}^\top A [\vec{w}_j]_{\basis} =
	(P^i)^\top A P^j = P_i^\top (AP)^j = (P^\top AP)_{ij}$, da cui la tesi.
\end{proof}

\begin{definition}
	Si definisce \textbf{congruenza} la relazione di equivalenza $\cong$ (denotata anche come $\equiv$) definita nel seguente
	modo su $A, B \in M(n, \KK)$:
	
	\[ A \cong B \defiff \exists P \in GL(n, \KK) \mid A = P^\top A P. \]
\end{definition}

\begin{remark}
	Si può facilmente osservare che la congruenza è in effetti una relazione di equivalenza. \\
	
	\li $A = I^\top A I \implies A \cong A$ (riflessione), \\
	\li $A \cong B \implies A = P^\top B P \implies B = (P^\top)\inv A P\inv = (P\inv)^\top A P\inv \implies B \cong A$ (simmetria), \\
	\li $A \cong B$, $B \cong C$ $\implies A = P^\top B P$, $B = Q^\top C Q$, quindi $A = P^\top Q^\top C Q P =
	(QP)^\top C (QP) \implies A \cong C$ (transitività). 
\end{remark}

\begin{remark}
	Si osservano alcune proprietà della congruenza. \\
	
	\li Per il teorema di cambiamento di base del prodotto scalare, due matrici associate a uno stesso
	prodotto scalare sono sempre congruenti (esattamente come due matrici associate a uno stesso
	endomorfismo sono sempre simili). \\
	\li Se $A$ e $B$ sono congruenti, $A = P^\top B P \implies \rg(A) = \rg(P^\top B P) = \rg(BP) = \rg(B)$,
	dal momento che $P$ e $P^\top$ sono invertibili; quindi il rango è un invariante per congruenza. Allora
	si può ben definire il rango $\rg(\varphi)$ di un prodotto scalare come il rango della matrice
	associata di $\varphi$ in una qualsiasi base di $V$. \\
	\li Se $A$ e $B$ sono congruenti, $A = P^\top B P \implies \det(A) = \det(P^\top B P) = \det(P^\top) \det(B) \det(P)=
	\det(P)^2 \det(B)$. Quindi, per $\KK = \RR$, il segno del determinante è un altro invariante per congruenza.
\end{remark}

\subsection{Studio del radicale \texorpdfstring{$V^\perp$}{V⟂} attraverso \texorpdfstring{$M_\basis(\varphi)$}{M\_B(φ)}}

\begin{definition}
	Si definisce il \textbf{radicale} di un prodotto scalare $\varphi$ come lo spazio:
	
	\[ V^\perp = \{ \vec{v} \in V \mid \varphi(\vec{v}, \vec{w}) = 0 \, \forall \vec{w} \in V \} \]
	
	\vskip 0.05in
\end{definition}

\begin{remark}
	Il radicale del prodotto scalare canonico su $\RR^n$ ha dimensione nulla, dal momento che $\forall \vec{v} \in \RR^n \setminus \{\vec{0}\}$, $q(\vec{v}) = \varphi(\vec{v}, \vec{v}) > 0 \implies \v \notin V^\perp$. In
	generale ogni prodotto scalare definito positivo (o negativo) è non degenere, dal momento che ogni vettore
	non nullo non è isotropo, e dunque non può appartenere a $V^\perp$.
\end{remark}

\begin{definition}
	Un prodotto scalare si dice \textbf{degenere} se il radicale dello spazio su tale prodotto scalare ha
	dimensione non nulla.
\end{definition}

\begin{remark}
	Sia $\alpha_\varphi : V \to \dual{V}$ la mappa\footnote{In letteratura questa mappa, se invertibile, è nota come \textit{isomorfismo musicale}, ed è in realtà indicata come $\flat$.} tale che
	$\alpha_\varphi(\vec{v}) = p$, dove $p(\vec{w}) = \varphi(\vec{v}, \vec{w})$ $\forall \v$, $\w \in V$. \\
	
	Si osserva che $\alpha_\varphi$ è un'applicazione lineare. Infatti, $\forall \v$, $\w$, $\U \in V$,
	$\alpha_\varphi(\v + \w)(\U) = \varphi(\v + \w, \U) = \varphi(\v, \U) + \varphi(\w, \U) =
	\alpha_\varphi(\v)(\U) + \alpha_\varphi(\w)(\U) \implies \alpha_\varphi(\v + \w) = \alpha_\varphi(\v) + \alpha_\varphi(\w)$. Inoltre $\forall \v$, $\w \in V$, $\lambda \in \KK$, $\alpha_\varphi(\lambda \v)(\w) =
	\varphi(\lambda \v, \w) = \lambda \varphi(\v, \w) = \lambda \alpha_\varphi(\v)(\w) \implies
	\alpha_\varphi(\lambda \v) = \lambda \alpha_\varphi(\v)$.
	
	Si osserva inoltre che $\Ker \alpha_\varphi$ raccoglie tutti
	i vettori $\v \in V$ tali che $\varphi(\v, \w) = 0$ $\forall \w \in W$, ossia esattamente i vettori di $V^\perp$, per cui si conclude che $V^\perp = \Ker \alpha_\varphi$ (per cui $V^\perp$ è effettivamente uno
	spazio vettoriale). Se $V$ ha dimensione finita, $\dim V = \dim \dual{V}$,
	e si può allora concludere che $\dim V^\perp > 0 \iff \Ker \alpha_\varphi \neq \{\vec{0}\} \iff \alpha_\varphi$ non è
	invertibile (infatti lo spazio di partenza e di arrivo di $\alpha_\varphi$ hanno la stessa dimensione). In
	particolare, $\alpha_\varphi$ non è invertibile se e solo se $\det(\alpha_\varphi) = 0$. \\
	
	Sia $\basis = (\vv{1}, ..., \vv{n})$ una base ordinata di $V$. Si consideri allora la base ordinata del
	duale costruita su $\basis$, ossia $\dual{\basis} = (\vecdual{v_1}, ..., \vecdual{v_n})$. Allora
	$M_{\basisdual}^\basis(\alpha_\varphi)^i = [\alpha_\varphi(\vv{i})]_{\basisdual} = \Matrix{\varphi(\vec{v_i}, \vec{v_1}) \\ \vdots \\ \varphi(\vec{v_i}, \vec{v_n})} \underbrace{=}_{\varphi \text{ è simmetrica}}
	\Matrix{\varphi(\vec{v_1}, \vec{v_i}) \\ \vdots \\ \varphi(\vec{v_n}, \vec{v_i})} = M_\basis(\varphi)^i$. Quindi
	$M_{\basisdual}^\basis(\alpha_\varphi) = M_\basis(\varphi)$. \\
	
	Si conclude allora che $\varphi$ è degenere se e solo se $\det (M_\basis(\varphi)) = 0$ e che
	$V^\perp \cong \Ker M_\basis(\varphi)$ mediante l'isomorfismo del passaggio alle coordinate.
\end{remark}