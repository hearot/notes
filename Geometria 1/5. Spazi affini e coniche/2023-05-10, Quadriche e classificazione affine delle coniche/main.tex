\documentclass[11pt]{article}
\usepackage{personal_commands}
\usepackage[italian]{babel}

\usepackage[a4paper, total={7in, 8in}]{geometry}

\title{\textbf{Note del corso di Geometria 1}}
\author{Gabriel Antonio Videtta}
\date{10 maggio 2023}

\begin{document}
	
	\maketitle
	
	\begin{center}
		\Large \textbf{Quadriche e classificazione affine delle coniche}
	\end{center}
	
	\begin{note}
		Nel corso del documento si assume $\Char \KK \neq 2$.
	\end{note}
	
	\begin{definition}[quadriche] Si dice \textbf{quadrica} il luogo di zeri
		di un polinomio $p \in \KK[x_1, \ldots, x_n]$ con $\deg p = 2$.
	\end{definition}
	
	\begin{definition}[coniche] Si dice \textbf{conica} una quadrica relativa ad un polinomio
		in due variabili.
	\end{definition}
	
	\begin{remark}\nl
		\li Una quadrica è invariante per la relazione $\sim$ su $\KK[x_1, \ldots, x_n]$, dove
		$p_1 \sim p_2 \defiff \exists \alpha \in \KK^* \mid p_1 = \alpha p_2$. Infatti
		il luogo di zeri di un polinomio non varia se esso viene moltiplicato per una costante non nulla di $\KK$. \\
		\li Una quadrica può essere vuota (come nel caso della conica relativa a $x^2 + y^2 + 1$ in $\RR$). \\
		\li Si identifica con la notazione $p(\x)$ con $\x \in \KK^n$, la valutazione del polinomio $p$ nelle coordinate
		di $\x$. Per esempio, se $\x = (1, 2)$ e $p(x, y) = x^2 + y^2$, con $p(\x)$ si identifica il valore
		$p(1, 2) = 1^2 + 2^2 = 5$.
	\end{remark}
	
	\begin{remark} [riscrittura di $p$ mediante matrici]
		Sia $p \in \KK[x_1, \ldots, x_n]$ di grado due. Allora $p$ si può sempre scrivere come $p_2 + p_1 + p_0$,
		dove $p_i$ è un polinomio omogeneo contenente soltanto monomi di grado $i$. \\
		
		In particolare, $p_2(x_1, \ldots, x_n)$ può essere sempre riscritto come $\sum_{i=1}^n \sum_{j=1}^n a_{ij}$
		con $a_{ij} \in \KK$ con $a_{ij} = a_{ji}$.
		È infatti sufficiente "sdoppiare" il coefficiente $c_{ij}$
		di $x_i x_j$ in due metà, in modo tale che $c_{ij} x_i x_j = \frac{c_{ij}}{2} x_i x_j + \frac{c_{ij}}{2} x_i x_j = \frac{c_{ij}}{2} x_i x_j + \frac{c_{ij}}{2} x_j x_i$. Inoltre, anche $p_1(x_1, \ldots, x_n)$ può essere  riscritto come $\sum_{i=1}^n b_{ij}$. \\
		
		Si possono allora considerare la matrice $A \in M(n, \KK)$ ed il vettore $\vec b \in \KK^n$, definiti in modo tale che:
		
		\[ A = (a_{ij})_{i,j=1\mbox{--}n}, \qquad \vec b = (b_i)_{i=1\mbox{--}n} \in \KK^n. \]
		
		\vskip 0.05in
		
		Infatti, $A$ e $\vec b$ soddisfano la seguente identità:
		
		\[ p(\x) = \x^\top A \x + \vec b^\top \x + c, \]
		
		\vskip 0.05in
		
		che, riscritta tramite l'identificazione di $\AnK$ come l'iperpiano $H_{n+1} \in \Aa_{n+1}(\KK)$,
		diventa:
		
		\[ p(\x) = {\hat \x}^\top \hat A \hat \x, \quad \dove \hat A = \Matrix{A & \rvline & \nicefrac{\vec b}{2} \, \\ \hline \nicefrac{{\vec b}^\top}{2} & \rvline & c }. \]
		
		\vskip 0.05in
		
		Si osserva che $\hat A$ è una matrice simmetrica di taglia $n+1$ a elementi in $\KK$, e in quanto
		tale essa induce un prodotto scalare su $\KK^{n+1}$. Pertanto la quadrica relativa $p$ è esattamente
		l'intersezione tra $H_{n+1}$ e $\CI(\hat A)$, identificando $\KK^{n+1}$ come $H_{n+1}$, ossia
		la quadrica è esattamente $\iota\inv(H_{n+1} \cap \CI(\hat A))$.
	\end{remark}
	
	\begin{definition}[matrice associata ad una quadrica]
		Si definisce la costruzione appena fatta di $\hat A$ come la \textbf{matrice associata alla quadrica relativa a $p$}, e si indica con $\MM(p)$. In particolare, $A$ è detta la matrice che rappresenta la \textit{parte quadratica}, e si indica con $\AA(p)$, mentre $\nicefrac{\vec b}2$ rappresenta la \textit{parte lineare}, indicata con $\Ll(p)$,
		e $c = c(p)$ è detto \textit{termine noto}.
	\end{definition}
	
	\begin{definition}[azione di $A(\Aa_n(\KK))$ su $\KKxn$]
		Sia $f \in A(\Aa_n(\KK))$. Allora $A(\Aa_n(\KK))$ agisce (a destra) su $\KKxn$ in modo tale che
		$p' = p \circ f$ è un polinomio per cui $p'(\x) = p(f(\x))$.
	\end{definition}

	\begin{definition}[equivalenza affine tra polinomi e quadriche]
		Si dice che due polinomi $p_1$, $p_2 \in \KKxn$ sono affinemente equivalenti se e solo se $\exists f \in A(\AnK) \mid p_1 = p_2 \circ f$.
		In tal caso si scrive che $p_1 \sim p_2$. Analogamente due quadriche
		si dicono affinemente equivalenti se i relativi polinomi sono
		affinemente equivalenti.
	\end{definition}

	\begin{remark}\nl
		\li L'equivalenza affine è una relazione di equivalenza. \\
		\li Sia $Z(p)$ il luogo di zeri di $p$. Allora, $p_1 \sim p_2 \implies
		\exists f \in A(\AnK) \mid Z(p_2) = f(Z(p_1))$. \\
		\li In generale, se $p_1 = p_2 \circ f$, vale che $Z(p_2) = f(Z(p_1))$. \\
		\li Dal momento che $A(\AnK)$ su $\KKxn$ è un azione (destra)
		di gruppo, vale che $(p \circ f_1) \circ f_2 = p \circ (f_1 \circ f_2)$ $\forall f_1$, $f_2 \in A(\AnK)$, $p \in \KKxn$.
	\end{remark}
	
	\begin{proposition} [formula del cambiamento della matrice associata su azione di $A(\Aa_n(\KK))$]
		Sia $f \in A(\Aa_n(\KK))$ e sia $p \in \KK[x_1, \ldots, x_n]$ di grado due. Allora vale
		la seguente identità:
		
		\begin{equation*}
			\MM(p \circ f) = {\hat M}^\top \MM(p) \hat M = \Matrix{M^\top \AA(p) M & \rvline & M^\top(\AA(p) \vec t + \Ll(p)) \, \\ \hline \, \left(M^\top(\AA(p) \vec t + \Ll(p))\right)^\top & \rvline & p(\vec t)},
		\end{equation*}
	
		\vskip 0.05in
	
		con $\hat M = \Matrix{ M & \rvline & \vec t \, \\ \hline 0 & \rvline & 1 \, }$, dove $f(\x) = M \x + \vec t$ $\forall \x \in \KK^n$ con $M \in \GL(n, \KK)$ e $\vec t \in \KK^n$.
	\end{proposition}
	
	\begin{proof}
		Per definizione, $p \circ f$ è tale che $(p \circ f)(\x) = p(f(\x)) =
		p(M\x + \vec t)$. In particolare, $(p \circ f)(\x) = \widehat{\left( M \x + \vec t \right)^\top} \MM(p) \widehat{\left( M \x + \vec t \right)} = \left( \hat M \hat x \right)^\top \!\! \MM(p) \left( \hat M \hat x \right)$. Pertanto vale che:
		
		\[ (p \circ f)(\x) = \hat x^\top \hat M^\top \MM(p) \hat M \hat x \implies \MM(p \circ f) = {\hat M}^\top \MM(p) \hat M, \]
		
		\vskip 0.05in
		
		da cui la tesi.
	\end{proof}

	\begin{remark}\nl
		\li Per la proposizione precedente, due matrici, associate a due
		polinomi di secondo grado affinemente equivalenti, variano
		per congruenza, così come le matrici della parte quadratica. \\
		
		Pertanto $\rg(\MM(p \circ f)) = \rg(\MM(p))$, come $\rg(\AA(p \circ f))
		= \rg(\AA(p))$ (così come, per $\KK=\RR$, non variano i segni
		dei vari determinanti). Allo stesso
		tempo, la classe di equivalenza di $\MM(p)$ è rappresentata completamente per $\KK = \CC$ (tramite il rango) e per $\KK = \RR$
		(tramite la segnatura), per il teorema di Sylvester. \\

		\li Se $f$ è una traslazione, $M = I_n$, e dunque la formula
		si riduce alla seguente:
		
		\[ \MM(p \circ f) = \Matrix{\AA(p) & \rvline & \AA(p) \vec t + \Ll(p) \, \\ \hline \, \left(\AA(p) \vec t + \Ll(p)\right)^\top & \rvline & p(\vec t)}. \]
		
		\vskip 0.05in
		
		In particolare, non varia la matrice relativa alla parte quadratica,
		ossia vale che $\AA(p \circ f) = \AA(p)$. \\
		
		\li Se $\lambda \in \KK^*$, $\MM(\lambda p) = \lambda \MM(p)$, dal
		momento che $\AA(\lambda p) = \lambda \AA(p)$, così come
		$\Ll(\lambda p) = \lambda \Ll(p)$ e $c(\lambda p) = \lambda c(p)$.
		Tuttavia, a differenza del cambio di matrice per equivalenza
		affine, per $\KK=\RR$ la segnatura non è più un invariante (infatti, in generale $\sigma(-S) = (\iota_-(S), \iota_+(S), \iota_0(S))$, se $S \in \Sym(n, \RR)$). Ciononostante non varia, in valore assoluto, la differenza tra l'indice di positività
		e quello di negatività, ossia $S(\MM(p)) := \abs{\iota_+ - \iota_-}$ continua ad essere invariante. \\
		
		\li Vale sempre la disuguaglianza $\rg(\MM(p)) \geq \rg(\AA(p)) \geq 1$, dal momento che $\AA(p)$ è
		una sottomatrice di $\MM(p)$ e che $p$, per definizione
		di quadrica, contiene sempre un termine quadratico
		(e dunque la matrice $\AA(p)$ non è mai nulla).
	\end{remark}

	\begin{definition} [quadrica non degenere]
		Una quadrica relativa a $p \in \KKxn$ si dice \textbf{non degenere} se $\rg(\MM(p)) = n+1$ (ossia se $\det(\MM(p)) \neq 0$), e altrimenti
		si dice degenere. In particolare, una conica si dice \textit{non degenere} se $\rg(\MM(p)) = 3$ e degenere altrimenti.
	\end{definition}

	\begin{definition} [quadrica a centro]
		Una quadrica $C$ relativa a $p \in \KKxn$ (o $p$ stesso) si dice \textbf{a centro} se
		$\exists \x_0 \in \KK^n \mid p(\x_0 + \x) = p(\x_0 - \x)$ $\forall \x \in \KK^n$. In particolare, si dice che tale $\x_0$ è un \textbf{centro di simmetria} per $C$.
	\end{definition}

	\begin{remark}\nl
		\li Si osserva che $\vec 0$ è un centro di simmetria per $p$ se
		$p(\x) = p(-\x)$, ossia se e solo se la parte lineare $\Ll(p)$ è
		nulla. \\
		
		\li Allora $\x_0$ è un centro di simmetria per $p$ se e solo se $\vec 0$
		è un centro di simmetria per $p \circ f$, dove $f$ è la traslazione
		che manda $\vec 0$ in $\x_0$. Infatti, in tal caso, vale che $f(\x) = \x + \x_0$ e che:
		
		\[ (p \circ f)(\x) = p(\x + \x_0) = p(\x - \x_0) = (p \circ f)(-\x). \]
		
		\vskip 0.05in
		
		\li Per le osservazioni precedenti, vale allora che $\x_0$ è un centro
		di simmetria per $p$ se e solo se la parte lineare di $p \circ f$
		è nulla, ossia se e solo se $\x_0$ è tale che $\AA(p) \x_0 + \Ll(p)$.
		Pertanto $p$ è a centro se e solo se il sistema $\AA(p) \x = - \Ll(p)$
		è risolvibile, e quindi se e solo se $\rg\!\Matrix{\AA(p) & \rvline & \Ll(p)} = \rg(\AA(p))$ $\iff \Ll(p) \in \Im(\AA(p))$, per il teorema di Rouché-Capelli. Vale
		dunque che $p$ è sempre a centro, se $\AA(p)$ è invertibile. \\
		
		Poiché i centri di una conica sono esattamente le soluzioni del
		sistema lineare $\AA(p) \x = - \Ll(p)$, essi formano un sottospazio
		affine. In particolare, se $\x_0$ è un centro, vale che tale sottospazio
		è esattamente $\x_0 + \Ker \AA(p)$. Pertanto, se $\AA(p)$ è invertibile
		(ossia se è iniettiva), il centro è unico.
	\end{remark}

	\hr
	
	\begin{theorem} [classificazione delle coniche complesse]
		Sia $\KK=\CC$. Allora ogni conica è affinemente equivalente ad
		un'equazione canonica della seguente tabella, unicamente
		determinata dagli invarianti $\rg(\MM(p))$ e $\rg(\AA(p))$.
		
		\begin{center}
			\begin{tabular}{|l|l|l|l|l|}
				\hline
				& $\rg(\MM(p))$ & $\rg(\AA(p))$ & Equazione canonica & A centro \\ \hline
				$\mathcal{C}_1$ & 3             & 2             & $x^2+y^2=1$        & Sì       \\ \hline
				$\mathcal{C}_2$ & 3             & 1             & $x^2=y$            & No       \\ \hline
				$\mathcal{C}_3$ & 2             & 2             & $x^2+y^2=0$        & Sì       \\ \hline
				$\mathcal{C}_4$ & 2             & 1             & $x^2=1$          & Sì       \\ \hline
				$\mathcal{C}_5$ & 1             & 1             & $x^2=0$            & Sì       \\ \hline
			\end{tabular}
		\end{center}
	\end{theorem}

	\vskip 0.01in

	\begin{proof}
		La classificazione è completa perché sono comprese tutte le possibili
		scelte di rango. Inoltre tale classificazione è ben definita, dal momento che due coniche distinte della tabella differiscono di almeno un'invariante, e pertanto non possono essere affinemente
		equivalenti. Pertanto, se esiste, una conica è affinemente equivalente
		ad una sola delle coniche presenti nella tabella. \\
		
		Sia allora $\mathcal{C}$ una conica relativa al polinomio $p \in \CC[x, y]$. Se $\rg(\AA(p)) = 2$, allora, per il teorema di Sylvester
		complesso, esiste una matrice $M \in \GL(2, \CC)$ tale per
		cui $M^\top \AA(p) M = I_2$. \\
		
		Si consideri allora l'affinità $f_1 \in A(\Aa_2(\CC))$ tale per cui $f_1(\x) = M\x + \vec t$, dove $\vec t = - \AA(p)\inv \vec b$. Se $p_1 = p \circ f_1$, allora, per la formula
		di cambiamento della matrice associata, vale che:
		
		\[ \MM(p_1) = \MM(p \circ f_1) = \Matrix{I_2 & \rvline & 0 \, \\ \hline \, 0 & \rvline & p(\vec t)}. \]
		
		\vskip 0.05in
		
		Se $\rg(\MM(p)) = 2$, $c(p_1) = p(\vec t)$ è nullo (altrimenti i ranghi di $\MM(p)$ e $\MM(p_1)$ sarebbero diversi; assurdo, dal momento che il rango di $\MM(p)$ è invariante per equivalenza affine, \Lightning).
		In tal caso $p_1$ è il polinomio $x^2 + y^2$, e
		dunque $\mathcal{C}$ è affinemente equivalente a $\mathcal{C}_3$ tramite
		l'identità $p_1 = p \circ f_1$. \\
		
		Se invece $\rg(\MM(p)) = 3$, $c' := c(p_1)$ non è nullo,
		e dunque $p_1$ è il polinomio $x^2 + y^2 + c'$. Considerando
		allora $f_2 \in A(\Aa_2(\CC))$ tale che $f_2(\x) = \sqrt{-c\,'} \, \x$, si ottiene che $p_2 = p_1 \circ f_2$ è tale per cui:
		
		\[ \MM(p_2) = -c' \Matrix{ I_2 & \rvline & 0 \\ \hline 0 & \rvline & -1 }, \]
		
		\vskip 0.05in
		
		ossia $p_2$ è il polinomio $c'(x^2 + y^2 - 1) = 0$. Poiché
		$c'$ è diverso da zero, $p_2$ ha lo stesso luogo di zeri
		di $x^2 + y^2 - 1$, ossia $p_2$ è legato alla conica
		$\mathcal{C}_1$. Si conclude dunque che $p$ e $p_2$
		sono affinemente equivalenti tramite l'identità
		$p_2 = p \circ \, (f_1 \circ f_2)$. \\
		
		Sia ora invece $\rg(\AA(p)) = 1$. Allora, sempre per
		il teorema di Sylvester complesso, esiste $M \in \GL(2, \CC)$
		tale per cui:
		
		\[ B := M^\top \AA(p) M = \Matrix{1 & 0 \\ 0 & 0}. \]
		
		\vskip 0.05in
		
		Si consideri allora l'affinità $f_1 \in A(\Aa_2(\CC))$ tale
		per cui $f_1(\x) = M \x$. Allora, se $p_1 = p \circ f_1$, vale che:
		
		\[ \MM(p_1) = \MM(p \circ f_1) = \Matrix{ 1 & 0 & b_1 \\ 0 & 0 & b_2 \\ b_1 & b_2 & c(p) }, \]
		
		\vskip 0.05in
		
		dove $(b_1, b_2)^\top = M^\top \Ll(p)$. Se $\rg(\MM(p)) = 3$, $b_2$ è necessariamente non nullo (altrimenti
		$\rg(\MM(p \circ f_1)) \leq 2$, \Lightning). Si consideri
		allora l'affinità $f_2 \in A(\Aa_2(\CC))$ tale che
		$f_2(\x) = \x - \vec t_1$, dove $\vec t_1 = (-b_1, 0)^\top$.
		Allora, se $p_2 = p_1 \circ f_2$, vale che:
		
		\[ \MM(p_2) = \MM(p_1 \circ f_2) = \Matrix{1 & 0 & 0 \\ 0 & 0 & b_2 \\ 0 & b_2 & c'}, \]
		
		\vskip 0.05in
		
		dove $c' := p_1(\vec t_1)$. Pertanto $p_2$ è il polinomio
		$x^2 + 2b_2 y + c'$. Si cerca adesso di eliminare il termine
		noto considerando una traslazione di vettore $\vec t_2$ in
		modo tale che $p_2(\vec t_2) = 0$ e che rimanga invariata
		la parte lineare. Se $\vec t_2 = (x', y')^\top$, si considera
		$x' = 0$ in modo tale da lasciare invariata la parte lineare
		e si cerca $y'$ in modo tale che:
		
		\[ 2b_2 y' + c' = 0 \implies y' = -\frac{c'}{2 b_2}. \]
		
		\vskip 0.05in
		
		Sia dunque $f_3 \in A(\Aa_2(\CC))$ tale che $f_3(\x) = \x + \vec t_2$. Se $p_3 = p_2 \circ f_3$, vale allora che:
		
		\[ \MM(p_3) = \MM(p_2 \circ f_3) = \Matrix{1 & 0 & 0 \\ 0 & 0 & b_2 \\ 0 & b_2 & 0}. \]
		
		\vskip 0.05in
		
		Pertanto $p_3$ è il polinomio $x^2 + 2b_2 y$. Sostituendo
		allora $y \mapsto -\nicefrac{y}{2b_2}$, si può normalizzare il
		coefficiente di $y$. Si considera allora $f_4 \in A(\Aa_2(\CC))$ tale che:
		
		\[ f_4(\x) = \Matrix{1 & 0 \\ 0 & \nicefrac{-y}{2b_2}} \x. \]
		
		\vskip 0.05in
		
		Se si pone allora $p_4 = p_3 \circ f_4$, si ottiene
		finalmente che:
		
		\[ \MM(p_4) = \MM(p_3 \circ f_4) = \Matrix{1 & 0 & 0 \\ 0 & 0 & -\nicefrac{1}{2} \\ 0 & -\nicefrac{1}{2} & 0}, \]
		
		\vskip 0.05in
		
		e dunque $p_4$ rappresenta il polinomio $x^2 - y$,
		legato alla conica $\mathcal{C}_2$. Si conclude dunque
		che $\mathcal{C}$ è affinemente equivalente a $\mathcal{C}_2$
		tramite l'identità $p_4 = p \circ \, (f_1 \circ f_2 \circ f_3 \circ f_4)$. \\
		
		Se invece $\rg(\MM(p)) \leq 2$, $b_2$ è necessariamente
		nullo (altrimenti $\rg(\MM(p \circ f_1)) = 3$, \Lightning).
		Si cerca adesso una traslazione di vettore $\vec t = (t_1, t_2)^\top$
		tale che annulli la parte lineare del polinomio, ossia
		un vettore per cui $\AA(p_1) \vec t + (b_1, 0)^\top = \vec 0$. Un vettore di questo tipo è $\vec t = (-b_1, 0)^\top$. \\
		
		Sia allora $f_2 \in \Aa_2(\CC)$ per cui $f_2(\x) = \x + \vec t$, e sia $p_2 = p_1 \circ f_2$. Vale allora che:
		
		\[ \MM(p_2) = \Matrix{1 & 0 & 0 \\ 0 & 0 & 0 \\ 0 & 0 & c'}, \]
		
		\vskip 0.05in
		
		dove $c' := p_1(\vec t)$. Se $\rg(\MM(p)) = 1$,
		$c'$ è necessariamente nullo (altrimenti $\MM(p_2)$ non
		sarebbe congruente a $\MM(p)$, \Lightning), e dunque
		$p_2$ è il polinomio $x^2 = 0$, legato alla conica $\mathcal{C}_5$ (quindi $\mathcal{C}$ è affinemente equivalente a $\mathcal{C}_5$ tramite l'identità $p_2 = p \circ \, (f_1 \circ f_2)$). \\
		
		Altrimenti, se $\rg(\MM(p)) = 2$, $c' \neq 0$. Sia
		allora $f_3 \in A(\Aa_2(\CC))$ tale che:
		
		\[ f_3(\x) = \Matrix{\sqrt{-c'\,} & 0 \\ 0 & 1} \x. \]
		
		\vskip 0.05in
		
		Se $p_3 = p_2 \circ f_3$, allora risulta che:
		
		\[ \MM(p_3) = \MM(p_2 \circ f_3) = -c' \Matrix{1 & 0 & 0 \\ 0 & 0 & 0 \\ 0 & 0 & -1}, \]
		
		\vskip 0.05in
		
		e dunque $p_3$ è il polinomio $-c'(x^2 - 1)$. Poiché
		$c' \neq 0$, $p_3$ ha lo stesso luogo di zeri di
		$x^2 - 1$, e dunque è legato alla conica $\mathcal{C}_4$.
		Allora $\mathcal{C}$ è affinemente equivalente a
		$\mathcal{C}_4$ mediante l'identità $p_3 = p \circ (f_1 \circ f_2 \circ f_3)$, concludendo la classificazione
		delle coniche complesse.
	\end{proof}

	\begin{theorem} [classificazione delle coniche reali]
		Sia $\KK=\RR$. Allora ogni conica è affinemente equivalente ad
		un'equazione canonica della seguente tabella, unicamente
		determinata dagli invarianti $\rg(\MM(p))$, $\rg(\AA(p))$,
		$S(\MM(p)) := \abs{\iota_+(\MM(p)) - \iota_-(\MM(p))}$ e
		$S(\AA(p)) := \abs{\iota_+(\AA(p)) - \iota_-(\AA(p))}$. \\[0.1in]
		
		\centering\small
		\begin{tabular}{|l|l|l|l|l|l|}
			\hline
			& $\rg(\MM(p))$ & $\rg(\AA(p))$ & $S(\MM(p))$ & $S(\AA(p))$ & Equazione canonica \\ \hline
			ellisse reale ($\mathcal{C}_1$) & 3 & 2 & 1 & 2 & $x^2+y^2-1=0$ \\ \hline
			iperbole ($\mathcal{C}_2$) & 3 & 2 & 1 & 0 & $x^2-y^2-1=0$ \\ \hline
			parabola ($\mathcal{C}_3$) & 3 & 1 & 1 & 1 & $x^2-y=0$ \\ \hline
			due rette reali incidenti ($\mathcal{C}_4$) & 2 & 2 & 0 & 0 & $x^2-y^2=0$ \\ \hline
			due rette reali parallele ($\mathcal{C}_5$) & 2 & 1 & 0 & 1 & $x^2-1=0$ \\ \hline
			due rette reali coincidenti ($\mathcal{C}_6$) & 1 & 1 & 1 & 1 & $x^2=0$ \\ \hline
			ellisse immaginaria ($\mathcal{C}_7$) & 3 & 2 & 3 & 2 & $x^2+y^2+1=0$ \\ \hline
			\begin{tabular}[c]{@{}l@{}}due rette complesse coniugate\\ e incidenti in un punto reale ($\mathcal{C}_8$)\end{tabular} & 2 & 2 & 2 & 2 & $x^2+y^2=0$ \\ \hline
			\begin{tabular}[c]{@{}l@{}}due rette complesse coniugate,\\ distinte e parallele ($\mathcal{C}_9$)\end{tabular} & 2 & 1 & 2 & 1 & $x^2+1=0$ \\ \hline
		\end{tabular}
	\end{theorem}

	\vskip 0.1in

	%TODO: terminare dimostrazione della classificazione
	\begin{proof}
		Come già visto precedentemente, la classificazione è completa perché sono comprese tutte le possibili
		scelte di invarianti, ed è anche ben definita, dacché
		due coniche distinte della tabella differiscono di almeno un'invariante. \\
		
		Sia allora $\mathcal{C}$ una conica relativa al polinomio $p \in \RR[x, y]$. Sia $\rg(\AA(p)) = 2$.
		Se $S(\AA(p)) = 2$, allora, per il teorema di Sylvester, $\exists M \in \GL(2, \RR) \mid M^\top \AA(p) M = \pm I_2$. Sia allora
		$f_1 \in A(\AA_2(\RR))$ l'affinità tale per cui
		$f_1(\vec x) = M \vec x + \vec t$, dove $\vec t = - \AA(p)\inv \vec b$. Allora, detto $p_1$ il polinomio monico ottenuto moltiplicando eventualmente per $-1$ il polinomio $p \circ f_1$, vale che:
		
		\[ \MM(p_1) = \Matrix{I_2 & \rvline & 0 \, \\ \hline \, 0 & \rvline & c}, \]
		
		\vskip 0.05in
		
		dove $c \in \RR$. Se $\rg(\MM(p)) = 2$, allora
		$c$ deve necessariamente essere nullo. In tal caso
		$p_1(x, y) = x^2 + y^2$, la cui conica corrispondente
		è data da due rette complesse coniugate e incidenti in un punto reale ($\mathcal{C}_8$). \\
		
		Altrimenti, se
		$\rg(\MM(p)) = 3$, si discutono due casi dipendentemente dal valore di $S(\MM(p))$. Se
		$S(\MM(p)) = 3$, allora $c$ è necessariamente positivo. Pertanto, detta $f_2 \in A(\AA_2(\RR))$
		l'affinità tale per cui $f_2(\vec x) = \sqrt{c} \, \vec x$ e detto $p_2 = p_1 \circ f_2$, vale che $\MM(p_2) = c \, I_3$, ossia che $p_2(x, y) = c(x^2 + y^2 + 1)$. Si è ottenuto dunque che $\mathcal{C}$ è affinemente equivalente all'ellisse immaginaria ($\mathcal{C}_7$). \\
		
		Si procede analogamente se $S(\MM(p)) = 1$: in
		tal caso $c$ è necessariamente negativo, e quindi
		$f_2$ si costruità moltiplicando per $\sqrt{-c}$:
		si ottiene in questo modo l'ellisse reale ($\mathcal{C}_1$). \\
		
		Sia ora invece $S(\AA(p)) = 1$. Allora, per il teorema di Sylvester, $\exists M \in \GL(2, \RR) \mid M^\top \AA(p) M = \SMatrix{1 & 0 \\ 0 & -1}$.
		Si costruisca allora l'affinità $f_1 \in A(\AA_2(\RR))$ in modo tale che $f_1(\vec x) = M \vec x + \vec t$, dove $\vec t = -\AA(p) \vec b$.
		Detto allora $p_1 = p \circ f_1$, vale che:
		
		\[ \MM(p_1) = \Matrix{\begin{smallmatrix}
				1 & 0 \\ 0 & -1
			\end{smallmatrix} & \rvline & 0 \, \\ \hline \, 0 & \rvline & c}. \]
		
		\vskip 0.05in
		
		Se $\rg(\MM(p)) = 2$, allora $c$ è necessariamente nullo, e quindi $p_1(x, y) = x^2 - y^2$, da cui
		si deduce che $\mathcal{C}$ è affinemente
		equivalente alla conica generata da due rette
		reali incidenti ($\mathcal{C}_4$). Se invece
		$\rg(\MM(p)) = 3$, $c$ non è nullo, e quindi
		si può costruire l'affinità $f_2 \in A(\AA_2(\RR))$
		data da $f_2(\vec x) = \sqrt{\abs{c}} \, \vec x$. Allora, detto $p_2 = f \circ p_1$, $p_2$ può essere
		sempre ricondotto a un
		multiplo di $x^2 - y^2 - 1$: se infatti $c < 0$,
		$p_2$ lo è già, altrimenti è sufficiente applicare
		una terza affinità $f_3(\vec x) = \SMatrix{0 & 1 \\ 1 & 0} \, \vec x$ e considerare $p_3 = p_2 \circ f_3$. Pertanto $\mathcal{C}$ è in questo caso
		affinemente equivalente a un'iperbole ($\mathcal{C}_2$). \\
		
		Sia adesso $\rg(\AA(p)) = 1$. Allora, per il teorema
		di Sylvester, $\exists M \in \GL(2, \RR) \mid M^\top \AA(p) M = \SMatrix{1 & 0 \\ 0 & 0}$. Sia $\Ll(p) = \SMatrix{b_1 \\ b_2}$, con $b_1$, $b_2 \in \RR$. Si costruisca $f_1 \in A(\AA_2(\RR))$ in modo tale
		che $f_1(\vec x) = M \vec x$. Detto
		$p_1 = p \circ f_1$, vale che:
		
		\[ \MM(p_1) = \MM(p \circ f_1) = \Matrix{1 & 0 & b_1 \\ 0 & 0 & b_2 \\ b_1 & b_2 & c(p)}. \]
		
		\vskip 0.1in
		
		Si consideri dunque l'affinità $f_2 \in A(\AA_2(\RR))$ costruita in modo tale che
		$f_2(\vec x) = \vec x - (b_1, 0)^\top$. Detto
		quindi $p_2 = p_1 \circ f_2$, vale che:
		
		\[ \MM(p_2) = \Matrix{1 & 0 & 0 \\ 0 & 0 & b_2 \\ 0 & b_2 & c'}, \]
		
		\vskip 0.07in
		
		dove $c' \in \RR$. Se $\rg(\MM(p)) = 3$, allora $b_2$ è necessariamente
		non nullo. Si cerca adesso di eliminare
		il termine noto $c'$ mediante una traslazione:
		si consideri $f_3 \in A(\AA_2(\RR))$ definita in modo tale che $f_3(\vec x) = \vec x + (0, -\frac{c}{2 b_2})^\top$, analogamente a come
		era stata impostata l'affinità nel caso complesso.
		Allora, detto $p_3 = p_2 \circ f_2$, vale che:
		
		\[ \MM(p_3) = \Matrix{1 & 0 & 0 \\ 0 & 0 & b_2 \\ 0 & b_2 & 0}. \]
		
		\vskip 0.05in
		
		Normalizzando il coefficiente di $y$ mediante
		l'affinità $f_4 \in A(\AA_2(\RR))$ tale per cui $f_4(\vec x) = \SMatrix{1 & 0 \\ 0 & -\frac{1}{2b_2}}$,
		e detto $p_4 = p_3 \circ f_4$, si ottiene finalmente
		che $p_4(x, y) = x^2 - y$, ossia che $\mathcal{C}$ è
		affinemente equivalente a una parabola ($\mathcal{C}_3$). \\
		
		Se $\rg(\MM(p)) = 2$, allora necessariamente
		$b_2 = 0$ e $c \neq 0$. Si costruisce dunque
		l'affinità $f_3 \in A(\AA_2(\RR))$ definita in
		modo tale che $f_3(\vec x) = \SMatrix{\sqrt{\abs{c'}} & 0 \\ 0 & 1}$ e si pone
		$p_3 = p_2 \circ f_3$. Se $S(\MM(p)) = 0$, allora necessariamente $c' < 0$, e quindi vale che $p_3$ è multiplo di $x^2 - 1$. Pertanto $\mathcal{C}$ è affinemente
		equivalente alla conica generata da due rette reali parallele ($\mathcal{C}_5$). Se invece $S(\MM(p)) = 2$, $c'$ è strettamente positivo, e quindi $p_3$ è
		multiplo di $x^2 + 1$. In tal caso $\mathcal{C}$ è affinemente equivalente alla conica
		generata da due rette complesse coniugate, distinte e parallele ($\mathcal{C}_9$). \\
		
		Se invece $\rg(\MM(p)) = 1$, sia $b_2$ che $c$ devono
		essere nulli. Allora $p_2(x, y) = x^2$, da cui
		si deduce che $\mathcal{C}$ è affinemente
		equivalente alla conica generata da due rette
		reali coincidenti ($\mathcal{C}_6$), completando la classificazione.
	\end{proof}

	\begin{remark}
		È utile osservare che la classificazione delle
		coniche complesse è una mera conseguenza della
		classificazione delle coniche reali. È possibile
		infatti dedurre le coniche complesse
		``dimenticando'' il segno nelle equazioni canoniche
		delle coniche reali. Formalmente è sufficiente
		costruire un'affinità in modo tale che una variabile
		venga moltiplicata per $i$ per far sì che il segno
		scompaia.
	\end{remark}
\end{document}
