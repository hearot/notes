%--------------------------------------------------------------------
\chapter{Probabilità sulla retta reale}
\setlength{\parindent}{2pt}

\begin{multicols*}{2}

Discutiamo in questa sezione la teoria della probabilità sulla
retta reale, uscendo dunque dal caso discreto. \smallskip

Per restringere la $\sigma$-algebra su cui lavoreremo (ossia l'insieme degli
eventi interessanti), siamo costretti a limitarci a una $\sigma$-algebra molto più
piccola di $\PP(\RR)$, la $\sigma$-algebra dei boreliani, che ci permette di escludere
``casi meno interessanti''. \smallskip

\begin{warn}
    Eccetto che nella prima sezione, assumeremo se non detto altrimenti
    di star lavorando sullo spazio misurabile
    $(\RR, \BB(\RR))$ dotato eventualmente della misura di Lebesgue $m$. $\BB(\RR)$ ed
    $m$ sono definiti nella sezione seguente.
\end{warn} 

\section{Cenni di teoria della misura}

\subsection{La \texorpdfstring{$\sigma$}{σ}-algebra di Borel e funzioni boreliane}

\begin{definition}[$\sigma$-algebra dei boreliani]
    Dato uno spazio metrico separabile\footnote{
        Si può generalizzare in modo naturale tale definizione a un qualsiasi spazio topologico.
        Dal momento che considereremo solo spazi metrici separabili (in particolare $X \subseteq \RR^d$), concentreremo
        le proprietà e le definizioni su questa classe di spazi topologici.} $X \neq \emptyset$
    si definisce la \textbf{$\sigma$-algebra $\BB(X)$ dei boreliani di $X$} (o
    $\sigma$-algebra di Borel)
    come la $\sigma$-algebra generata dai suoi aperti, ovverosia:
    \[
        \BB(X) \defeq \sigma \{ A \subseteq X \mid A \text{ aperto}\, \}.
    \]
    Gli elementi della $\sigma$-algebra di Borel sono detti \textit{boreliani}.
\end{definition}

\begin{proposition}[Proprietà di $\BB(X)$]
    Sia $X \neq \emptyset$ uno spazio metrico separabile. Allora valgono
    le seguenti affermazioni:

    \begin{enumerate}[(i.)]
        \item $\BB(X)$ contiene tutti gli aperti e i chiusi di $X$ (infatti
        metrico e separabile implica II-numerabile), pertanto se $\tau(X)$ è la
        topologia di $X$ vale che $\tau(X) \subseteq \BB(X)$,
        \item $\BB(X) = \sigma \{ A \subseteq X \mid A \text{ chiuso}\, \}$, ossia
        $\BB(X)$ è generata anche dai chiusi di $X$ (infatti $\BB(X)$ è chiuso per
        complementare),
        \item se $Y \subseteq X$, $Y \neq \emptyset$ ha metrica indotta da $X$, allora
        $\BB(Y) = \sigma \{ Y \cap B \mid B \in \BB(X) \} \subseteq \BB(X)$ (segue dal fatto che
        gli aperti di $Y$ sono tutti e solo gli aperti di $X$ intersecati a $Y$).
    \end{enumerate}
\end{proposition}

\begin{proposition}[Proprietà di $\BB(\RR^d)$]
    Valgono le seguenti affermazioni:
    \begin{enumerate}[(i.)]
        \item $\BB(\RR)$ contiene tutti gli intervalli e tutte le semirette (infatti si ammettono anche intersezioni infinite di aperti),
        \item $\BB(\RR)$ è generato dagli intervalli semiaperti, ovverosia $\BB(\RR) = \sigma \{ (a, b] \mid a, b \in \RR, a < b \}$,
        \item $\BB(\RR)$ è generato dalle semirette, ovverosia $\BB(\RR) = \sigma \{ (-\infty, a) \mid a \in \RR \}$,
        \item $\BB(\RR^d) = \sigma \{ (-\infty, a_1) \times \ldots \times (-\infty, a_n) \mid a_1, \ldots, a_n \in \RR \}$ (segue da (iii.)),
        \item $\BB(\RR^d) \neq \PP(\RR^d)$ (segue dal controesempio di Vitali, oltre che da considerazioni sulle cardinalità).
    \end{enumerate}
\end{proposition}

\begin{definition}
    Data una funzione $f : X \to Y$ con $X$ e $Y$ spazi metrici separabili, si dice che
    $f$ è una \textbf{funzione boreliana} se $f\inv(A)$ è boreliano per ogni
    $A$ boreliano di $Y$. Equivalentemente $f$ è boreliana se la controimmagine di ogni
    boreliano è un boreliano.
\end{definition}

\begin{proposition}
    Sia $f : X \to Y$ con $X$ e $Y$ spazi metrici separabili una funzione continua. Allora
    $f$ è boreliana. \smallskip


    Segue dal fatto che $\BB(Y)$ è generato dagli aperti di $Y$, le cui controimmagini sono
    aperte, e dunque boreliane.
\end{proposition}

\subsection{Definizione e proprietà di misura, \texorpdfstring{$\pi$}{π}-sistemi per \texorpdfstring{$\sigma$}{σ}-algebre}

\begin{definition}[Misura]
    Dato $(\Omega, \FF)$ spazio misurabile, una misura $\mu$ su $(\Omega, \FF)$ è una
    funzione $\mu : \FF \to [0, \infty]$ con $\mu(\emptyset) = 0$ e per cui valga
    la $\sigma$-additività, ovverosia:
    \[
        \mu\left(\bigcupdot_{i \in \NN} A_i\right) = \sum_{i \in \NN} \mu(A_i), \quad A_i \in \FF.
    \]
\end{definition}

\begin{remark}[Proprietà basilari di una misura]
    Dal momento che si richiede per una misura valga $\mu(\emptyset) = 0$, si verifica
    facilemente che vale la $\sigma$-additività finita. \smallskip


    Inoltre, se $A \subseteq B$, allora $\mu(B) = \mu(B \setminus A \cupdot A) = \mu(B \setminus A) + \mu(A)$, e
    dunque vale sempre che $\mu(A) \leq \mu(B)$. Vale inoltre ancora la $\sigma$-subadditività, con la stessa
    dimostrazione data per la probabilità, e dunque:
    \[
        \mu\left(\bigcup_{i \in \NN} A_i\right) \leq \sum_{i \in \NN} \mu(A_i).
    \]
\end{remark}

\begin{remark}[Comportamento di $\mu$ al limite]
    Se $(A_i)_{i \in \NN}$ è una famiglia numerabile di
    insiemi in $\FF$, allora, seguendo la stessa dimostrazione
    data per le misure di probabilità, che:

    \begin{enumerate}[(i.)]
        \item $A_i \goesup A \implies \mu(A_i) \goesup \mu(A)$,
        \item $A_i \goesdown A \implies \mu(A_i) \goesdown \mu(A)$.
    \end{enumerate}
\end{remark}

\begin{definition}
    Una misura $\mu$ su $(\Omega, \FF)$ si dice \textbf{misura finita} se $\mu(\Omega)$ è finito.
\end{definition}

\begin{proposition}[Proprietà di una misura finita $\mu$]
    Sia $\mu$ una misura finita su $(\Omega, \FF)$. Allora valgono le seguenti affermazioni:
    \begin{enumerate}[(i.)]
        \item $P(A) = \frac{\mu(A)}{\mu(\Omega)}$ è una misura di probabilità,
        \item $\mu(A)$ è sempre finito e $\mu(\Omega) = \mu(A) + \mu(A^c)$,
        \item $A \subseteq B \implies \mu(B) = \mu(B \setminus A) + \mu(A)$,
        \item $\mu(B \setminus A) = \mu(B) - \mu(A \cap B)$,
        \item $\mu(A \cup B) = \mu(A \Delta B \cupdot A \cap B) = \mu(A) + \mu(B) - \mu(A \cap B)$,
        \item $\mu\left(\bigcup_{i \in [n]} A_i\right) = \sum_{j \in [n]} (-1)^{j+1} \sum_{1 \leq i_1 < \cdots < i_j \leq n} \mu\left(\bigcap_{k \in [j]} A_{i_{k}}\right)$ (Principio di inclusione-esclusione per le misure finite).
    \end{enumerate}

    Tutte le affermazioni seguono immediatamente dalla prima.
\end{proposition}

\begin{definition}[Insiemi $\mu$-trascurabili e proprietà che accadono $\mu$-quasi certamente]
    Un insieme $A \in \FF$ si dice \textbf{$\mu$-trascurabile} se
    $\mu(A) = 0$. Una proprietà $M$ si dice che accade
    $\mu$-quasi certamente ($\mu$-q.c.) se esiste $A \in \FF$ $\mu$-trascurabile per cui
    $M$ accade per $A^c$.
\end{definition}

\begin{definition}[\texorpdfstring{$\pi$}{π}-sistema di una $\sigma$-algebra]
    Sia $(\Omega, \FF)$ uno spazio misurabile. Allora un sottoinsieme $\mathcal{C} \subseteq \FF$
    si dice \textbf{$\pi$-sistema di $\FF$} se:
    \begin{enumerate}[(i.)]
        \item $A$, $B \in \mathcal{C} \implies A \cap B \in \mathcal{C}$ (chiusura per intersezioni),
        \item $\sigma(C) = \FF$ (genera $\FF$).
    \end{enumerate}
\end{definition}

\begin{remark}
    Un $\pi$-sistema di una $\sigma$-algebra svolge lo ``stesso ruolo'' che una
    base svolge per una topologia.
\end{remark}

\begin{lemma}[di Dynkin, versione probabilistica]
    Sia $(\Omega, \FF)$ uno spazio misurabile e sia $\mathcal{C}$ un suo $\pi$-sistema. Siano
    $P$ e $Q$ due probabilità sullo spazio misurabile di $\Omega$. Se $P$ e $Q$ coincidono su
    $\mathcal{C}$, allora $P \equiv Q$.
\end{lemma}

\begin{example}
    Alcuni esempi di $\pi$-sistemi per $(\RR, \BB(\RR))$ sono:
    \begin{itemize}
        \item gli aperti, ovverosia $\mathcal{C} = \{ A \in \FF \mid A \text{ aperto}\, \}$ (oppure i chiusi),
        \item le semirette (a sinistra), ovverosia $\mathcal{C} = \{ (-\infty, a] \mid a \in \RR \}$ (oppure le semirette a destra),
        \item gli intervalli semiaperti (a sinistra), ovverosia $\mathcal{C} = \{ (a, b] \mid a, b \in \RR, b > a \}$ (oppure semiaperti a destra).
    \end{itemize}
\end{example}

\subsection{La misura di Lebesgue}

\begin{theorem}[Esistenza e unicità della misura di Lebesgue]
    Esiste ed è unica la misura $m$ su $(\RR, \BB(\RR))$ tale per cui
    $m([a, b]) = b-a$ per ogni $a$, $b \in \RR$ con $b > a$. Tale misura
    è detta \textbf{misura di Lebesgue} e corrisponde al concetto ``primitivo'' di
    \textit{lunghezza}. \smallskip


    L'unicità segue dall'enunciato generale del lemma di Dynkin.
\end{theorem}

\begin{remark}
    Dal momento che $m([0, 1]) = 1$,
    la misura $\restr{m}{[0,1]}$ è una misura di probabilità su $([0,1], \BB([0, 1]))$,
    detta \textit{probabilità uniforme su $[0,1]$}. Analogamente per $a$, $b \in \RR$
    con $b > a$, $m([a, b]) = b-a$ e
    dunque $P = \frac{1}{b-a} \restr{m}{[a,b]}$ è una misura di probabilità (detta
    \textit{probabilità uniforme su $[a,b]$}). \smallskip


    Assumendo l'assioma della scelta si può dimostrare che \underline{non} si può estendere in modo coerente
    $\restr{m}{[0,1]}$ a $([0, 1], \PP([0, 1]))$.
\end{remark}

\section{Probabilità reale, funzione di ripartizione (f.d.r.) e proprietà}

\subsection{Definizioni e corrispondenza tra f.d.r.~e probabilità reale}

\begin{definition}
    Si dice \textbf{probabilità reale} una qualsiasi
    probabilità $P$ su $(\RR, \BB(\RR))$.
\end{definition}

\begin{definition}[Funzione di ripartizione di $P$]
    Data una probabilità reale $P$ si definisce
    allora la sua \textbf{funzione di ripartizione (f.d.r.)}
    come la funzione $F : \RR \to [0, 1]$ tale per cui:
    \[
        F(x) = P((-\infty, x]), \quad \forall x \in \RR.
    \]
    Si definisce inoltre $F(\pm\infty) \defeq \lim_{x \to \pm\infty} F(x)$.
    Indicheremo $F$ come $F_P$, e quando $P$ sarà nota dal contesto
    ci limiteremo a scrivere $F$.
\end{definition}

\begin{proposition}[Proprietà della f.d.r.]
    Sia $P$ una probabilità reale. Allora, se $F$ è la
    sua f.d.r. vale che:
    \begin{enumerate}[(i.)]
        \item $F$ è crescente, ovvero $F(x) \geq F(y) \impliedby x \geq y$ (infatti $(-\infty, x] \supseteq (-\infty, y]$),
        \item $F$ è continua a destra, ovverosia per ogni $\tilde{x} \in \RR$ vale che $\lim_{x \to \tilde{x}^+} F(x) = F(\tilde{x})$,
        \item $F(-\infty) = 0 \impliedby ((-\infty, -i])_{i \in \NN} \goesdown \emptyset$,
        \item $F(\infty) = 1 \impliedby ((-\infty, i])_{i \in \NN} \goesup \RR$.
    \end{enumerate}


    L'affermazione (ii.)~segue dal fatto che per ogni successione decrecente da destra $(x_i)_{i \in \NN} \goesdown \tilde{x}$,
    che esclude $\tilde{x}$, è
    tale per cui $((-\infty, x_i])_{i \in \NN} \goesdown (-\infty, \tilde{x}]$, e dunque
    $(F(x_i))_{i \in \NN} = (P((-\infty, x_i]))_{i \in \NN} \goesdown P((-\infty, \tilde{x}]) = F(\tilde{x})$.
\end{proposition}

\begin{proposition}[$P$ è univocamente determinata da $F$]
    Sia $F : \RR \to \RR$ una funzione tale per cui:
    \begin{enumerate}[(i.)]
        \item $F$ è crescente,
        \item $F$ è continua a destra,
        \item $\lim_{x \to \infty} F(x) = 1$,
        \item $\lim_{x \to -\infty} F(x) = 0$.
    \end{enumerate}
    Allora $0 \leq F \leq 1$ ed esiste un'unica probabilità reale $P$ avente
    $F$ come funzione di ripartizione. \smallskip


    L'unicità segue dal lemma di Dynkin.
\end{proposition}

\begin{remark}
    La continuità a sinistra della f.d.r.~non è invece garantita dacché per ogni successione da sinistra crescente
    $(x_i)_{i \in \NN} \goesup \tilde{x}$, che esclude $\tilde{x}$,
    vale che $((-\infty, x_i])_{i \in \NN} \goesup (-\infty, \tilde{x})$, e non
    $(-\infty, \tilde{x}]$. Dunque $\lim_{x \to \tilde{x}^-} F(x)$ esiste ed è $P((-\infty, x))$, indicato
    comunemente come $F(x^-)$, che può non coincidere con $F(x)$. \smallskip

    Dal momento che:
    \[
        P(\{x\}) = P((-\infty, x] \setminus (-\infty, x)) = F(x) - F(x^-),
    \]
    si deduce che $F$ è continua se e solo se $P(\{x\}) = 0$ (ossia se e solo se
    $F(x) = F(x^-)$).
\end{remark}

\begin{remark}
    Si deducono immediatamente dalla precedente osservazione le seguenti identità:
    \begin{itemize}
        \item $P([a, b]) = F(b) - F(a^-)$,
        \item $P((a, b)) = F(b^-) - F(a)$,
        \item $P([a, b)) = F(b^-) - F(a^-)$,
        \item $P((a, b]) = F(b) - F(a)$.
    \end{itemize} 
\end{remark}

\begin{definition}[$P$ continua]
    Si dice che una probabilità reale $P$ è \textbf{continua} se
    la sua f.d.r.~$F$ lo è, ossia se $P(\{a\}) = 0$ per ogni $a \in \RR$
    (quest'ultima equivalenza deriva dalla penultima osservazione). 
\end{definition}

\begin{remark}
    Per una probabilità $P$ continua la misura di un intervallo con estremi $a$ e $b$ è semplificata
    a $F(b) - F(a)$ in tutti i casi (infatti $F(a^-) = F(a)$ e $F(b^-) = F(b)$).  
\end{remark}

\section{Classi di probabilità reale: discreta e assolutamente continua (AC)}

Esistono due classi importanti, ma non esaustive, di probabilità reale: le
probabilità discrete e quelle continue, contenenti quelle assolutamente
continue. Le classi di probabilità reali
si dividono dunque secondo il seguente schema:

\begin{center}
    \tikzset{every picture/.style={line width=0.75pt}} %set default line width to 0.75pt        

    \begin{tikzpicture}[x=0.75pt,y=0.75pt,yscale=-1,xscale=1,scale=0.8]
    %uncomment if require: \path (0,300); %set diagram left start at 0, and has height of 300
    
    %Shape: Rectangle [id:dp7885262489349896] 
    \draw   (220.19,65.28) -- (466.19,65.28) -- (466.19,196.28) -- (220.19,196.28) -- cycle ;
    %Shape: Ellipse [id:dp8572353674963273] 
    \draw   (229.69,95.79) .. controls (236.04,78.39) and (264.48,72.78) .. (293.2,83.27) .. controls (321.92,93.76) and (340.05,116.37) .. (333.7,133.77) .. controls (327.34,151.17) and (298.91,156.78) .. (270.19,146.29) .. controls (241.47,135.8) and (223.33,113.19) .. (229.69,95.79) -- cycle ;
    %Shape: Ellipse [id:dp3583963732297444] 
    \draw   (342.58,156.41) .. controls (332.85,131.07) and (350.75,100.63) .. (382.58,88.41) .. controls (414.4,76.19) and (448.08,86.82) .. (457.81,112.15) .. controls (467.54,137.48) and (449.63,167.93) .. (417.81,180.15) .. controls (385.99,192.37) and (352.31,181.74) .. (342.58,156.41) -- cycle ;
    %Shape: Ellipse [id:dp5413476700533957] 
    \draw   (393.91,107.98) .. controls (397.1,99.22) and (408.98,95.52) .. (420.44,99.7) .. controls (431.9,103.89) and (438.6,114.38) .. (435.4,123.13) .. controls (432.21,131.89) and (420.33,135.59) .. (408.87,131.41) .. controls (397.41,127.22) and (390.71,116.73) .. (393.91,107.98) -- cycle ;
    
    % Text Node
    \draw (252,103) node [anchor=north west][inner sep=0.75pt]   [align=left] {discrete};
    % Text Node
    \draw (358,145) node [anchor=north west][inner sep=0.75pt]   [align=left] {continue};
    % Text Node
    \draw (403,105) node [anchor=north west][inner sep=0.75pt]   [align=left] {AC};
    \end{tikzpicture}
\end{center}

\subsection{Probabilità discreta e f.d.r.}

Come già discusso nella sezione della \textit{\hyperref[sec:discretizzazione]{Discretizzazione}},
una probabilità reale $P$ si dice \textit{discreta} se esiste $\Omega_0 \subseteq \RR$
discreto per cui $P$ è concentrata su $\Omega_0$. In tal caso, come già visto,
$P(A) = P(A \cap \Omega_0)$ per ogni $A \in \BB(\RR)$, e dunque $P$ è univocamente determinata
dalla densità discreta di $\restr{P}{\PP(\Omega_0)}$, che chiameremo $p$. \smallskip


In questo caso il range $R_P$ è dunque numerabile e, se $F$ è la f.d.r.~di $P$, vale che:
\[
    F(x) = P((-\infty, x]) = \sum_{\substack{y \in R_P \\ y \leq x}} p(y).
\]

\begin{remark}
    Se $P$ è discreta, come già osservato nella sezione della \textit{\hyperref[remark:identità_discreta_dirac]{Discretizzazione}},
    allora vale che:
    \[
        P = \sum_{x \in R_P} p(x) \, \delta_x.
    \]
\end{remark}

\begin{remark}
    Se $R_P$ non ha punti di accumulazione, allora $F$ è costante a tratti con salti
    negli $y \in R_P$ di ampiezza $p(y)$. \smallskip


    Al contrario, presa una successione $(p_r)_{r \in \QQ}$ con $\sum_{r \in \QQ} p_r = 1$,
    la probabilità $P = \sum_{r \in \QQ} p_r \, \delta_r$ è una probabilità discreta con
    f.d.r.~non costante a tratti (infatti tutti i punti di $\QQ$ sono punti di accumulazione). 
\end{remark}

Pertanto, se una probabilità reale è discreta, ci si può effettivamente restringere a tutti
i risultati della \textit{Parte 2}.

\end{multicols*}