\documentclass[11pt]{article}
\usepackage{personal_commands}
\usepackage[italian]{babel}

\title{\textbf{Note del corso di Analisi Matematica 1}}
\author{Gabriel Antonio Videtta}
\date{31 marzo e 4 aprile 2023}

\begin{document}
	
	\maketitle
	
	\wip
	
	\begin{center}
		\Large \textbf{Teoria sulle derivate}
	\end{center}

	\begin{definition} (derivata)
		Sia $f : X \subseteq \RR \to \RR$. Si definisce allora \textbf{derivata}
		di $f$ in $\xbar \in X$ punto di accumulazione, se esiste, il seguente limite:
		
		\[Df(\xbar) = f'(\xbar) = \lim_{h \to 0} \frac{f(\xbar + h) - f(\xbar)}{h} = \lim_{x \to \xbar} \frac{f(x) - f(\xbar)}{x - \xbar}.\]
		
		\vskip 0.05in
		
		Qualora tale limite non esista, si dirà che non esiste la derivata
		di $f$ in $\xbar$. Si definisce anche $f' : D \subseteq X \to \RRbar$ come la funzione derivata,
		la quale associa ogni punto $\xbar$ in cui la derivata di $f$ esiste al
		valore del limite computato in $\xbar$.
	\end{definition}
	
	\begin{definition}
		$\xbar \in X$ si dice \textbf{derivabile} se e solo se esiste la
		derivata di $f$ in $\xbar$ e $f'(\xbar)$ è finito.
	\end{definition}
	
	\begin{remark}\nl
		\li L'insieme $D$ può essere vuoto. \\
		\li Si definisce $f^{(n)}(\xbar)$ come la derivata $n$-esima
		di $f$ in $\xbar$. \\
		\li Si definisce per convenzione $f^{(0)}(x) = f(x)$. \\
		\li L'operazione di derivata è un operatore lineare. \\
	\end{remark}

	\begin{definition} (derivata destra e sinistra)
		Dato $\xbar$ punto di accumulazione destro di $X$, si definisce
		allora \textbf{derivata destra} di $f$ in $\xbar \in X$, se
		esiste, il seguente limite:
		
		\[D_+ f(\xbar) = f_+'(\xbar) = \lim_{h \to 0^+} \frac{f(\xbar + h) - f(\xbar)}{h} = \lim_{x \to \xbar^+} \frac{f(x) - f(\xbar)}{x - \xbar}.\]
		
		\vskip 0.05in
		
		Qualora tale limite non esista, si dirà che non esiste la derivata destra di $f$ in $\xbar$. Analogamente, per un punto di accumulazione sinistro $\xbar \in X$, si definisce
		la \textbf{derivata sinistra} di $f$ in $\xbar \in X$, se esiste, il seguente
		limite:
		
		\[D_- f(\xbar) = f_-'(\xbar) = \lim_{h \to 0^-} \frac{f(\xbar + h) - f(\xbar)}{h} = \lim_{x \to \xbar^-} \frac{f(x) - f(\xbar)}{x - \xbar}.\]
	\end{definition}

	\begin{remark}\nl
		\li Se esistono sia la derivata sinistra che destra di $f$ in $\xbar$
		e coincidono, allora la derivata di $f$ in $\xbar$ esiste e
		coincide con il valore di entrambe le due derivate. \\
		\li Vale anche il viceversa, se $\xbar$ è un punto di accumulazione
		sia destro che sinistro: se esiste la derivata di $f$ in $\xbar$,
		allora sia la derivata sinistra che destra esistono e coincidono
		con la derivata.
	\end{remark}

	\begin{definition}
		Si dice che $f : X \to \RR$ è derivabile se è derivabile $\forall x \in X$.
	\end{definition}
	
	\begin{definition}
		Si dice che $f \in \cc^1$ se è derivabile e la sua
		funzione derivata è continua. In generale, si dice che $f \in \cc^n$ se
		è derivabile $n$ volte e ogni sua derivata, fino alla $n$-esima,
		è continua. Si pone $f \in \cc^\infty$ se $f$ è derivabile per un
		numero arbitrario di volte e ogni sua derivata è continua.
	\end{definition}

	\begin{proposition}
		Sia $f : X \to \RR$ e sia $\xbar \in X$ un punto di accumulazione di $X$. Allora:
		
		\begin{enumerate}[(i)]
			\item $f$ derivabile in $\xbar$ $\implies$ $f(\xbar + h) = f(\xbar) + f'(\xbar) h + o(h)$.
			\item Se esiste $a$ tale che $f(\xbar + h) = f(\xbar) + ah + o(h)$,
			allora $f$ è derivabile in $\xbar$ e $f'(\xbar) = a$.
		\end{enumerate}
	\end{proposition}

	\begin{proof}
		Se $f$ è derivabile in $\xbar$, allora $\lim_{h \to 0} \frac{f(\xbar + h) - f(\xbar) - f'(\xbar) h}{h} = \lim_{h \to 0} \frac{f(\xbar + h) - f(\xbar)}{h} - f'(\xbar) = f'(\xbar) - f'(\xbar) = 0$, da cui la prima tesi. \\
		
		Inoltre, se esiste $a$ come nelle ipotesi, $\lim_{h \to 0} \frac{f(\xbar + h) - f(\xbar)}{h} =\lim_{h \to 0} \frac{ah + o(h)}{h} = a + \lim_{h \to 0} \frac{o(h)}{h} = a + 0 = a$, quindi $f$ è derivabile in $\xbar$ e $f'(\xbar) = a$.
	\end{proof}

	\begin{corollary}
		Se $f$ è derivabile in $\xbar$, allora $f$ è anche continua in $\xbar$.
	\end{corollary}

	\begin{proof}
		Infatti, poiché $f(x) = f(\xbar) + f'(\xbar) (x - \xbar) + o(x-\xbar)$,
		$\lim_{x \to \xbar} f(x) = \lim_{x \to \xbar} f(\xbar) + \lim_{x \to \xbar} f'(\xbar)(x-\xbar) + \lim_{x \to \xbar} o(x - \xbar) = \lim_{x \to \xbar} f(\xbar) = f(\xbar)$, e quindi $f$ è continua in $\xbar$.
	\end{proof}

	%TODO: trovare esempio di derivabilità infinita e non continuità

	\begin{proposition}
		Siano $f_1$, $f_2 : X \to \RR$ entrambe derivabili in
		$\xbar$. Allora:
		
		\begin{enumerate}[(i)]
			\item $(f_1 + f_2)'(\xbar) = f_1'(\xbar) + f_2'(\xbar)$,
			\item $(f_1f_2)'(\xbar)=  f_1(\xbar) f_2'(\xbar) + f_1'(\xbar) f_2(\xbar)$.
		\end{enumerate}
	\end{proposition}

	\begin{proof}Poiché $f_1$ ed $f_2$ sono derivabili in $\xbar$, vale
		che:
		
		\[ f_1(\xbar + h) = f_1(\xbar) + f_1'(\xbar) h + o(h), \qquad f_2(\xbar + h) = f_2(\xbar) + f_2'(\xbar) h + o(h). \]

		\begin{enumerate}[(i)]
			\item $(f_1 + f_2)(\xbar + h) = (f_1 + f_2)(\xbar) +
			(f_1' + f_2')(\xbar) h + o(h)$. Quindi, per la proposizione precedente, $(f_1 + f_2)'(\xbar) = (f_1' + f_2')(\xbar) =
			f_1'(\xbar) + f_2'(\xbar)$.
			\item $(f_1 f_2)(\xbar + h) = (f_1 f_2)(\xbar) + (f_1(\xbar)f_2'(\xbar) + f_1'(\xbar) f_2(\xbar)) h + \underbrace{(f_1(\xbar) + f_2(\xbar)) o(h) + (f_1'f_2')(\xbar) h^2 + (f_1'(\xbar) + f_2'(\xbar))h \cdot o(h) + o^2(h))}_{=o(h)} =
			(f_1 f_2)(\xbar) + (f_1(\xbar)f_2'(\xbar) + f_1'(\xbar) f_2(\xbar)) h + o(h)$. Quindi, per la proposizione precedente, $(f_1 f_2)'(\xbar) = f_1(\xbar)f_2'(\xbar) + f_1'(\xbar) f_2(\xbar)$.
		\end{enumerate}
	\end{proof}

	\begin{proposition}
		Siano $f : X \to Y$ e $g : Y \to \RR$, con $f$ derivabile in $\xbar$ e $g$ derivabile in $\ybar := f(\xbar)$. Allora $g \circ f$ è
		derivabile in $\xbar$ e $(g \circ f)'(\xbar) = f'(\xbar) g'(\ybar)$.
	\end{proposition}

	\begin{proof}
		Poiché $f'(\xbar)$ è finito, $f(\xbar + h) = \ybar + f'(\xbar) h + o(h)$. Analogamente, $g(\ybar + h) = g(\ybar) + g'(\ybar) h + o(h)$.
		Allora $g(f(\xbar + h)) = g(\ybar + (f'(\xbar) h + o(h))) =
		g(\ybar) + g'(\ybar) (f'(\xbar) h + o(h)) + o(f'(\xbar) h + o(h)) =
		g(\ybar) + g'(\ybar) f'(\xbar) h + o(h) + o(f'(\xbar) h + o(h))$. \\
		
		Si osserva che $\lim_{h \to 0} \frac{o(f'(\xbar) h + o(h))}{h} =
		\lim_{h \to 0} \frac{o(f'(\xbar) h + o(h))}{f'(\xbar) h + o(h)} \frac{f'(\xbar) h + o(h)}{h} = \lim_{h \to 0} \frac{o(f'(\xbar) h + o(h))}{f'(\xbar) h + o(h)} \lim_{h \to 0} \frac{f'(\xbar) h + o(h)}{h} =
		0 \cdot f'(\xbar) = 0$, e quindi che $o(f'(\xbar) h + o(h)) = o(h)$.
		Allora $g(f(\xbar + h)) = g(\ybar) + g'(\ybar) f'(\xbar) h + o(h)$,
		da cui si conclude che $(g \circ f)'(\xbar) = g'(\ybar) f'(\xbar)$.
	\end{proof}

	\begin{proposition}
		Sia $f : X \to Y$ con inversa $g : Y \to X$. Sia $f$ derivabile
		in $\xbar$ con $f'(\xbar) \neq 0$. Sia $g$ continua in $\ybar = f(\xbar)$. Allora:
		
		\begin{enumerate}[(i)]
			\item $\ybar$ è un punto di accumulazione di $Y$,
			\item $g$ è derivabile in $\ybar$,
			\item $g'(\ybar) = \frac{1}{f'(\xbar)}$.
		\end{enumerate}
	\end{proposition}

	\begin{proof}\nl
		\begin{enumerate}[(i)]
			\item Poichè $f$ è derivabile in $\xbar$, $f$ è continua
			in $\xbar$. Quindi per ogni intorno $I$ di $\ybar$, esiste
			un intorno $J$ di $\xbar$ tale per cui $f(I \cap X \setminus \{ \xbar \}) \subseteq J$. Inoltre, $I \cap X \setminus \{\xbar\}$ non
			è mai vuoto, dacché, essendo $f$ derivabile in $\xbar$, $\xbar$ è un punto di accumulazione di $X$. Quindi $J$ contiene in particolare un immagine di $f$ in esso, e quindi un punto di $Y$;
			inoltre, tale punto è diverso da $\ybar$ dal momento che $f$ è
			iniettiva, essendo bigettiva. Quindi $\ybar$ è un punto di accumulazione.
			\item e \!(iii) Poiché $f$ è derivabile in $g(\ybar)$,
			$\ybar + h = f(g(\ybar + h)) = f(g(\ybar) + (\underbrace{g(\ybar + h) - g(\ybar)}_k)) = \ybar + f'(\xbar) k +
			o(k)$, ossia vale che:
			
			\[ h = f'(\xbar) k + o(k). \]
			
			Dal momento che $g$ è continua in $\ybar$, $k \tends{h \to 0} 0$, e
			quindi $o(k) \tends{h \to 0} 0$. Quindi, per $h \to 0$, $k \sim \frac{h}{f'(\xbar)}$. Si conclude
			dunque che $\lim_{h \to 0} \frac{g(\ybar + h) - g(\ybar)}{h} =
			\lim_{h \to 0} \frac{k}{h} = \frac{1}{f'(\xbar)}$.
 		\end{enumerate}
	\end{proof}

	\begin{example}
		La continuità è necessaria nelle scorse ipotesi. Si può costruire
		infatti una funzione del tipo:
		
		\[ f(x) = \system{x & \se x \geq 0, \\ -(x+2) & \se -2 < x \leq -1.} \]
		
		dove $f'(0) = 1$, $f$ è invertibile, ma la derivata di $g$ in $0$ non
		esiste ($D_+ g(0) = 1$, ma $D_- g(0) = +\infty$).
	\end{example}

	\begin{theorem} (di Fermat)
		Sia $I$ intervallo, $f : I \to \RR$, $\xbar$ interno a $I$ punto
		di massimo o minimo locale con $f$ derivabile in $\xbar$, allora
		$f'(\xbar) = 0$.
	\end{theorem}

	\begin{example}
		Dimostrare che la derivata sinistra è negativa, e che quella
		destra è positiva nei casi che hai capito.
	\end{example}

	\begin{theorem} (di Rolle)
		Sia $I = [a, b] \subset \RR$ e sia $f : I \to \RR$ tale che
		$f$ sia continua su $I$, che $f(a) = f(b)$ e che $f$ sia derivabile
		in $[a, b]$. Allora $\exists \xbar \in (a, b)$ tale che $f'(\xbar) = 0$.
	\end{theorem}

	\begin{proof}
		Per il teorema di Weierstrass $f$ ammette un punto di massimo $M$ e uno di minimo $m$ in $I$. Se $f(a) = M$ e $f(b) = m$ o viceversa, la
		funzione $f$ è costante in $I$, e quindi per ogni punto in $(a, b)$
		la derivata è nulla, dacché $f$ è sempre derivabile. Altrimenti,
		sicuramente uno tra il punto di massimo e quello di minimo appartiene
		a $(a, b)$. Senza perdita di generalità, si assuma che $\exists x_M \in (a, b)$ tale che $f(x_M) = M$: per
		il teorema di Fermat $f'(x_M) = 0$. Analogamente per il caso in cui
		$\exists x_m \in (a, b)$ tale che $f(x_m) = m$, da cui la tesi.
	\end{proof}

	\begin{theorem} (di Cauchy)
		Sia $I = [a, b] \subset \RR$ e siano $f$, $g: I \to \RR$
		continue su $I$ e derivabili in $(a, b)$, con $g'$ non nulla
		in $(a, b)$ e $g(a) \neq g(b)$. Allora
		$\exists \xbar \in (a, b)$ tale che $\frac{f'(\xbar)}{g'(\xbar)} = \frac{f(b) - f(a)}{g(b)-g(a)}$.
	\end{theorem}

	\begin{proof}
		Si consideri la funzione $h : I \to \RR$ tale che $h(x) = f(x) - \left(\frac{f(b) - f(a)}{g(b) - g(a)} (g(x) - g(a)) + f(a)\right)$.
		Si osserva che $h$,
		essendo una somma di funzioni continue su $I$ e derivabili in $(a, b)$,
		è anch'essa continua su $I$ e derivabile in $(a, b)$. Inoltre
		$h(a) = h(b) = 0$. Quindi, per il teorema di Rolle, $\exists \xbar \in (a, b) \mid h'(\xbar) = 0 \implies \frac{f'(\xbar)}{g'(\xbar)} = \frac{f(b)-f(a)}{g(b)-g(a)}$,
		da cui la tesi.
	\end{proof}

	\begin{theorem} (di Lagrange)
		Sia $I = [a, b] \subset \RR$ e sia $f: I \to \RR$ tale che $f$
		sia continua su $I$ e che $f$ sia derivabile in $(a, b)$. Allora
		$\exists \xbar \in (a, b)$ tale che $f'(\xbar) = \frac{f(b) - f(a)}{b-a}$, ossia la cui retta tangente è parallela alla secante
		che passa per $(a, f(a))$ e $(b, f(b))$.
	\end{theorem}

	\begin{proof}
		Si consideri $g(x) = x$, $g$ è continua in $[a, b]$ e derivabile
		in $(a, b)$, con derivata sempre non nulla in tale intervallo.
		Allora, per il teorema di Cauchy, $\exists \xbar \in (a, b) \mid
		f'(\xbar) = \frac{f(b)-f(a)}{b-a}$, da cui la tesi.
	\end{proof}

	\begin{proposition}
		Sia $I = [a, b] \subset \RR$ e sia $f : I \to \RR$ tale che $f$
		sia continua su $I$ e che $f$ sia derivabile in $(a, b)$, con
		derivata non negativa. Allora $f$ è crescente in $[a, b]$.
		Analogamente, se la derivata è non positiva, $f$ è decrescente.
	\end{proposition}

	\begin{proof}
		Senza perdita di generalità si dimostra il caso in cui la derivata
		di $f$ in $(a, b)$ è non negativa (altrimenti è sufficiente considerare
		$g = -f$).
		Si considerino $c < d \in I$. Allora, per il teorema di Lagrange,
		$\exists \xbar \in (c, d) \mid f'(c) = \frac{f(d) - f(c)}{d-c}
		\implies f(d) - f(c) = \underbrace{f'(c) (d-c)}_{\geq 0} \implies
		f(d) \geq f(c)$, ossia che $f$ è crescente in $I$.
	\end{proof}

	\begin{remark}\nl
		\li L'interpretazione geometrica del teorema di Cauchy, rispetto
		a quella di Lagrange, è leggermente più complicata. Si consideri
		la curva $\gamma : \RR \to \RR^2$ tale che
		$\gamma(t) =(g(t), f(t))$. Si osserva che il coefficiente della
		retta tangente in $\xbar$ per $\gamma$ è dato da $\lim_{h \to 0} \frac{f(\xbar + h) - f(\xbar)}{g(\xbar + h) - g(\xbar)}$, che,
		sotto le ipotesi del teorema di Cauchy, può essere riscritto
		come $\frac{f'(\xbar)}{g'(\xbar)}$. Allora, il teorema di Cauchy
		asserisce che esiste un punto della curva $\gamma$ tale per cui
		la retta tangente alla curva in quel punto è parallela alla secante
		passante per $(g(a), f(a))$ e $(g(b), f(b))$.
	\end{remark}

	\begin{exercise}
		Dare un esempio di una funzione $f : \RR \to \RR$ crescente e
		discontinua $\forall x \in \ZZ$.
	\end{exercise}

	\begin{solution}
		Si consideri $f(x) = \lfloor x \rfloor$.
	\end{solution}

	\begin{exercise}
		Si descriva un insieme $X$ tale che i suoi punti di accumulazione
		sono $\{\pm 1\}$.
	\end{exercise}

	\begin{solution}
		Si consideri $X = \{1 + \frac{1}{n}\} \cup \{-1 + \frac{1}{n}\}$.
	\end{solution}

	\begin{exercise}
		Sia $f : X \to \RRbar$ continua in $\xbar$ e sia $a < f(\xbar)$.
		Allora esiste $J$ intorno di $\xbar$ tale che $a < f(x)$ $\forall
		x \in J$.
	\end{exercise}

	\begin{exercise}
		Sia $X \subseteq \RRbar$ e sia $\xbar$ punto di accumulazione di $X$,
		$f_1$, $f_2 : X \to \RRbar$. Allora:
		
	\begin{enumerate}[(i)]
		\item Se $f_1 \tendsto{\xbar} +\infty$ e $f_2$ è limitata inferiormente
		in un intorno $J$ di $\xbar$, allora $f_1(x) + f_2(x) \tendsto{\xbar} +\infty$.
		\item Se $f_1 \tendsto{\xbar} 0$ e $f_2$ è limitata in un intorno
		di $\xbar$, allora $f_1 f_2(x) \tendsto{\xbar} 0$.
		\item Se $f_1 \tendsto{\xbar} +\infty$ è limitata inferiormente
		da una costante positiva $m$ in un intorno $J$ di $\xbar$, allora
		$f_1 f_2 \tendsto{\xbar} +\infty$. 
	\end{enumerate}
	\end{exercise}

	\begin{exercise}
		Sia $f: \RR \to \RR$ tale che:
		
		\[ f(x) = \system{x + 2x^2 \sin\left(\frac{1}{x}\right) & \se x \neq 0, \\ 0 & \altrimenti.} \]
		
		\vskip 0.05in
		
		Mostrare che $f$ è continua, che $f'(0) = 1$ e che $f'$ non è continua in zero.
	\end{exercise}
\end{document}